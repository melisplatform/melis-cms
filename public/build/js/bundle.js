var melisCms=function(){var e,t=$("body"),i=($("document"),[]);function a(e,t,i){0===e?($("#"+i+" .form-group label").css("color","#686868"),$.each(t,function(e,t){$("#"+i+" .form-control[name='"+e+"']").prev("label").css("color","red")})):$("#"+i+" .form-group label").css("color","#686868")}function s(e){var t="string"==typeof e?e:$(this).data("pagenumber"),i=$(this).data("fatherpageid"),s=$("#"+t+"_id_meliscms_page form").serializeArray();if($("#"+t+"_id_page_taxonomy").length){var n=$("#"+t+"_id_page_taxonomy").data("tags").toString();s.push({name:"page_taxonomy",value:n})}s=$.param(s),$.ajax({type:"POST",url:"/melis/MelisCms/Page/savePage?idPage="+t+"&fatherPageId="+i,data:s,dataType:"json",encode:!0}).done(function(e){if(1===e.success){r(e.datas.idPage),melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),a(e.success,e.errors,e.datas.item_zoneid);var i=e.datas.item_zoneid;if("0_id_meliscms_page"===i){melisHelper.tabClose(i);var s=e.datas.idPage+i.substring(1,i.length),n=""!==e.datas.item_icon?e.datas.item_icon:"fa-file-o",o=e.datas.idPage+" - "+e.datas.item_name;melisHelper.tabOpen(o,n,s,e.datas.item_melisKey,{idPage:e.datas.idPage})}else melisHelper.zoneReload(t+"_id_meliscms_page","meliscms_page",{idPage:t})}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"#000"),a(e.success,e.errors,e.datas.item_zoneid);melisCore.flashMessenger()}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}function n(e){var t="string"==typeof e?e:$(this).data("pagenumber"),s=$("#"+t+"_id_meliscms_page form").serializeArray();if($("#"+t+"_id_page_taxonomy").length){var n=$("#"+t+"_id_page_taxonomy").data("tags").toString();s.push({name:"page_taxonomy",value:n})}s=$.param(s),$.ajax({type:"POST",url:"/melis/MelisCms/Page/publishPage?idPage="+t,data:s,dataType:"json",encode:!0}).done(function(e){1===e.success?(r(e.datas.idPage),$('.page-publishunpublish[data-pagenumber="'+t+'"]').bootstrapSwitch("setState",!0,!0),melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),a(e.success,e.errors,e.datas.item_zoneid),melisCore.flashMessenger(),$("#"+e.datas.item_zoneid+" .page-title h1:not('span')").text(e.datas.item_name),$(".tabsbar a[data-id='"+e.datas.item_zoneid+"'] .navtab-pagename").text(t+" - "+e.datas.item_name),$("#"+e.datas.item_zoneid+" .page-title .saved-version-notif").fadeOut(),melisHelper.zoneReload(t+"_id_meliscms_page","meliscms_page",{idPage:t}),i.push(e.datas.idPage)):(melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"#000"),a(e.success,e.errors,e.datas.item_zoneid)),melisCore.flashMessenger()}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}function o(e){var t="string"==typeof e?e:$(this).data("pagenumber");$.ajax({type:"GET",url:"/melis/MelisCms/Page/unpublishPage?idPage="+t,dataType:"json",encode:!0}).done(function(e){1===e.success?(r(t),melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),melisCore.flashMessenger(),i.push(t)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"#000"),melisCore.flashMessenger(),melisHelper.zoneReload(t+"_id_meliscms_page","meliscms_page",{idPage:t})}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}function r(e,t){optionalArg=void 0===t?0:t,$.ajax({url:"/melis/MelisCms/TreeSites/getPageIdBreadcrumb?idPage="+e+"&includeSelf="+optionalArg,encode:!0,dataType:"json"}).done(function(e){var t=[];$.each(e,function(e,i){t.push("/"+i),0===e&&i}),t=(t=t.toString()).replace(/,/g,"");var i=$("#id-mod-menu-dynatree").fancytree("getTree");i.reload({url:"/melis/MelisCms/TreeSites/get-tree-pages-by-page-id"}).done(function(){i.loadKeyPath(t,function(e,t){"ok"==t&&e.setActive(!0).done(function(){e.setExpanded(!0)})}).done(function(){i.clearFilter(),!1===$("#id-mod-menu-dynatree .ui-fancytree > li:last-child").hasClass("fancytree-lastsib")&&$("#id-mod-menu-dynatree .ui-fancytree > li:last-child").remove()})})}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}function l(e){var t=$(this).val().length,i=$(this).prev("label"),a=e.data.limit;i.find("span").length?0===t?(i.removeClass("limit"),i.find("span").remove()):(i.find("span").html('<i class="fa fa-text-width"></i>('+t+")"),t>a?(i.addClass("limit"),i.find("span").addClass("limit")):(i.removeClass("limit"),i.find("span").removeClass("limit"))):0!==t&&(i.find(".label-text").append("<span class='text-counter-indicator'><i class='fa fa-text-width'></i>("+t+")</span>"),t>a&&(i.addClass("limit"),i.find("span").addClass("limit")))}function d(e){$("#"+e+"_id_meliscms_page_action_tabs").removeClass("relative"),$("#"+e+"_id_meliscms_page_action_tabs li.btn-disabled").remove(),$("#"+e+"_id_meliscms_page .overlay-switch").remove(),"undefined"!=typeof loader&&loader.removePageEditionLoading()}return window.scrollToViewTinyMCE=function(t,i){if(e=$(window).scrollTop(),!t||!i)return e;var a=i/2-t;$("html, body").animate({scrollTop:a},300)},window.scrollOffsetTinyMCE=function(){return e},$(".sub-section").on("click",function(){var e=$(this);e.next(".cms-next").is(":visible")?e.next(".cms-next").hide():e.next(".cms-next").show()}),t.on("click",".tox-tbtn",function(){if($("#mce-modal-block").length)if($("iframe.melis-iframe").length){$("iframe.melis-iframe").position().top,$("iframe.melis-iframe").height();var e=screen.height;bodyOffsetTop=$(window)[0].scrollHeight;var t=$(".mce-window").outerHeight(),i=bodyOffsetTop+e-t;$(".mce-floatpanel.mce-window").css("top",i),$("html, body").animate({scrollTop:i},300)}else $("#mce-modal-block").css("z-index",1049),$(".mce-floatpanel.mce-window").css("z-index",1050)}),melisCore.screenSize>=768&&(jQuery(window).scroll(function(){var e=0;$("body").hasClass("sidebar-mini")||(e=$("#id_meliscore_leftmenu").outerWidth());var i=$("#"+activeTabId+" div.page-title").outerHeight();jQuery(window).scrollTop()>i&&melisCore.screenSize>1120?($("#"+activeTabId+" .page-head-container").css("padding-top","72px"),$("#"+activeTabId+" .page-head-container > .innerAll").addClass("sticky-pageactions"),$("#"+activeTabId+" .page-head-container > .innerAll").css({width:t.width()-e,left:e})):($("#"+activeTabId+" .page-head-container").removeAttr("style"),$("#"+activeTabId+" .page-head-container > .innerAll").removeClass("sticky-pageactions"),$("#"+activeTabId+" .page-head-container > .innerAll").removeAttr("style"))}),$("body.show-breadcrumb.show-nav-tabs").scroll(function(){var e=0;$("body").hasClass("sidebar-mini")||(e=$("#id_meliscore_leftmenu").outerWidth());var i=$("#"+activeTabId+" div.page-title"),a=$("#"+activeTabId+" div[data-meliskey='meliscms_pagehead_title']");i.length&&(i=Math.abs(i.offset().top)),a.length&&(a=$("#"+activeTabId+" div[data-meliskey='meliscms_pagehead_title']").offset().top);$("#"+activeTabId+" div.page-title").outerHeight();a<=0&&melisCore.screenSize>1120?($("#"+activeTabId+" .page-head-container").css("padding-top","61px"),$("#"+activeTabId+" .page-head-container > .innerAll").addClass("sticky-pageactions"),$("#"+activeTabId+" .page-head-container > .innerAll").css({width:t.width()-e,left:e})):($("#"+activeTabId+" .page-head-container").removeAttr("style"),$("#"+activeTabId+" .page-head-container > .innerAll").removeClass("sticky-pageactions"),$("#"+activeTabId+" .page-head-container > .innerAll").removeAttr("style"))})),t.on("click",".melis-newpage",function(){var e=$(this).data("pagenumber");melisHelper.tabClose("0_id_meliscms_page"),melisHelper.tabOpen(translations.tr_meliscms_page_creation,"fa-file-o","0_id_meliscms_page","meliscms_page_creation",{idPage:0,idFatherPage:e})}),t.on("click",".melis-savepage",s),t.on("click",".melis-clearpage",function(){var e=$(this).data(),t=e.pagenumber,i=(activeTabId,e.confirmmsg);melisCoreTool.confirm(translations.tr_meliscms_page_action_clear,translations.tr_meliscms_menu_cancel,translations.tr_meliscms_delete_saved_page_title,i,function(){$.ajax({type:"GET",url:"/melis/MelisCms/Page/clearSavedPage?idPage="+t,encode:!0}).done(function(e){1===e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),melisCms.refreshTreeview(t),melisCore.flashMessenger(),melisHelper.zoneReload(t+"_id_meliscms_page","meliscms_page",{idPage:t})):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"#000")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})}),t.on("click",".melis-publishpage",n),t.on("click",".melis-unpublishpage",o),t.on("click",".melis-deletepage",function(){var e=$(this).data().pagenumber,t=activeTabId,i=$(this).attr("disabled");void 0!==i&&!1!==i||melisCoreTool.confirm(translations.tr_meliscms_menu_delete,translations.tr_meliscms_menu_cancel,translations.tr_meliscms_delete_confirmation,translations.tr_meliscms_delete_confirmation_msg,function(){melisCms.refreshTreeview(e),$.ajax({url:"/melis/MelisCms/Page/deletePage?idPage="+e,encode:!0}).done(function(e){1===e.success?(melisHelper.tabClose(t),melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),melisCore.flashMessenger()):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"#000")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})}),t.on("click",".display-settings",function(){var e=0,t=$(this).data("display");$(".displaysettingsicon span.fa").removeClass(),$(".displaysettingsicon span:first-child").addClass(t),e="fa fa-desktop"===t?"100%":"fa fa-tablet"===t?"980px":"480px",$(this).parents(".page-head-container").next(".page-content-container").find(".melis-iframe").animate({width:e},300,function(){$("#"+activeTabId+" .melis-iframe").css("height","1000px");var e=$("#"+activeTabId+" .melis-iframe").contents().height()+50;$("#"+activeTabId+" .melis-iframe").css("height",e)})}),t.on("switch-change",".page-publishunpublish",function(e,t){var i=$(this).data("pagenumber").toString();!0===t.value?n(i):o(i)}),t.on("keyup keydown change","form[name='pageseo'] input[name='pseo_meta_title']",{limit:70},l),t.on("keyup keydown change","form[name='pageseo'] textarea[name='pseo_meta_description']",{limit:160},l),t.on("shown.bs.tab",".page-content-container .widget-head.nav ul li a",function(){$("form[name='pageseo'] input[name='pseo_meta_title']").trigger("keyup"),$("form[name='pageseo'] input[textarea='pseo_meta_description']").trigger("keyup");var e=$("#"+activeTabId+" .melis-iframe").contents().height();$("#"+activeTabId+" .melis-iframe").css("height",e)}),t.on("shown.bs.tab",".melis-refreshPageTable",function(){var e=$(this).parents(".melis-page-table-cont"),t=e.attr("id"),i=e.data("meliskey"),a=e.data("page-id");melisHelper.zoneReload(t,i,{idPage:a})}),t.on("click",".page-content-container .widget-head.nav ul li a.history, .page-content-container .widget-head.nav ul li a.more_windows",function(){var e=$(this).attr("href"),t=$(e);melisCore.screenSize<=767&&t.find(".melis-refreshPageTable").trigger("click")}),t.on("#melis-id-nav-bar-tabs [data-tool-meliskey='meliscms_page'] .tab-element",function(){var e=$(this),t=$("#"+e.data("id")).find(".iframe-container .tab-content .melis-iframe"),i=t.contents()[0].body.scrollHeight;t.css("height",i)}),{savePage:s,publishPage:n,unpublishPage:o,refreshTreeview:r,disableCmsButtons:function(e){$("#"+e+"_id_meliscms_page .page-publishunpublish").append("<div class='overlay-switch' style='width: 100%;height: 100%;position: absolute;top: 0;left: 0;z-index: 99999999;cursor: wait; '></div>"),$("#"+e+"_id_meliscms_page_action_tabs").addClass("relative").prepend("<li class='btn-disabled'></li>"),"undefined"!=typeof loader&&loader.addPageEditionLoading()},enableCmsButtons:d,iframeLoad:function(e){var t=$("body").find(".melis-iframe"),a=t.contents().height();t.closest(".meliscms-page-tab-edition").find("#loader"),t.css("height",a),t.css("min-height","700px"),d(e),i=[],$.ajax({url:"/melis/MelisCms/TreeSites/canEditPages",encode:!0}).done(function(e){var t=$("#id-mod-menu-dynatree").fancytree("getTree");0===e.edit?($(".meliscms-search-box.sidebar-treeview-search").hide(),$("#id-mod-menu-dynatree").prepend("<div class='create-newpage'><span class='no-access'>"+translations.tr_meliscms_no_access+"</span></div>")):0===t.count()?($(".meliscms-search-box.sidebar-treeview-search").hide(),$("#id-mod-menu-dynatree").prepend("<div class='create-newpage'><span class='btn btn-success'>"+translations.tr_meliscms_create_page+"</span></div>")):($(".meliscms-search-box.sidebar-treeview-search").show(),$("#id-mod-menu-dynatree .create-newpage").remove())}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)}),$.ajax({url:"/melis/MelisCms/Page/isActionActive?actionwanted=save",encode:!0}).done(function(e){0===e.active?$("body").addClass("disable-create"):$("body").removeClass("disable-create")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)}),$.ajax({url:"/melis/MelisCms/Page/isActionActive?actionwanted=delete",encode:!0}).done(function(e){0===e.active?$("body").addClass("disable-delete"):$("body").removeClass("disable-delete")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})},pageTabOpenCallback:function(e){i.push(e)}}}();$(function(){$("#pageIdRootMenu").parents(".form-group").find("label").addClass("d-flex flex-row justify-content-between")}),function(e,t,i){var a=e("body");e(t).on("load",function(){t.mainTree=function(t){var i,a=e("#tab-arrow-top");i=melisCore.screenSize<=767?["contextMenu","filter","glyph"]:["contextMenu","dnd","filter","glyph","persist"],e("#id-mod-menu-dynatree").fancytree({extensions:i,glyph:{map:{loading:"fa fa-spinner fa-pulse"}},persist:{cookiePrefix:"fancytree-1-",expandLazy:!0,overrideSource:!0,store:"auto"},activeVisible:!1,debugLevel:0,autoScroll:!0,generateIds:!0,idPrefix:"mt_",tabindex:"",toggleEffect:{height:"toggle",duration:250},source:{url:"/melis/MelisCms/TreeSites/get-tree-pages-by-page-id",cache:!0},contextMenu:{menu:{new:{name:translations.tr_meliscms_menu_new,icon:"paste"},edit:{name:translations.tr_meliscms_menu_edit,icon:"edit"},delete:{name:translations.tr_meliscms_menu_delete,icon:"delete"},dupe:{name:translations.tr_meliscms_menu_dupe,icon:"copy"},export:{name:translations.tr_melis_cms_tree_export_page,icon:"export"},import:{name:translations.tr_melis_cms_page_tree_import,icon:"import"}},actions:function(t,i,a){if("new"===i){var s=t.data;melisHelper.tabClose("0_id_meliscms_page"),melisHelper.tabOpen(translations.tr_meliscms_page_creation,"fa-file-text-o","0_id_meliscms_page","meliscms_page_creation",{idPage:0,idFatherPage:s.melisData.page_id})}if("edit"===i){s=t.data;melisHelper.tabOpen(s.melisData.page_title,s.iconTab,s.melisData.item_zoneid,s.melisData.item_melisKey,{idPage:s.melisData.page_id})}if("delete"===i){var n=(s=t.data).melisData.item_zoneid,o=s.melisData.page_id,r="root_1"==t.getParent().key?-1:t.getParent().key,l=e(".tabsbar a[data-id='"+n+"']").parent("li");melisCoreTool.confirm(translations.tr_meliscms_menu_delete,translations.tr_meliscms_menu_cancel,translations.tr_meliscms_delete_confirmation,translations.tr_meliscms_delete_confirmation_msg,function(){melisCms.refreshTreeview(r,1),e.ajax({url:"/melis/MelisCms/Page/deletePage?idPage="+o,encode:!0}).done(function(e){1===e.success?(1===l.length&&melisHelper.tabClose(n),melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),melisCore.flashMessenger()):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,"#000")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})}if("dupe"===i){s=t.data;n="id_meliscms_tools_tree_modal_form_handler",melisKey="meliscms_tools_tree_modal_form_handler",d="melis/MelisCms/TreeSites/renderTreeSitesModalContainer",melisHelper.createModal(n,melisKey,!1,{sourcePageId:s.melisData.page_id},d,function(){})}if("export"===i||"import"===i){var d="/melis/MelisCms/Page/renderPageExportImportModalHandler";s=t.data;"export"===i?melisHelper.createModal("id_meliscms_page_export_modal","meliscms_page_export_modal",!0,{pageId:s.melisData.page_id},d,function(){}):melisHelper.createModal("id_meliscms_page_import_modal","meliscms_page_import_modal",!0,{pageId:s.melisData.page_id},d,function(){})}}},lazyLoad:function(e,t){var i=t.node.data.melisData.page_id;t.result={url:"/melis/MelisCms/TreeSites/get-tree-pages-by-page-id?nodeId="+i,data:{mode:"children",parent:t.node.key},cache:!1}},create:function(t,i){melisHelper.loadingZone(e("#treeview-container"))},init:function(t,i,a){melisHelper.removeLoadingZone(e("#treeview-container")),e("input[name=left_tree_search]").focus(),0===e("#id-mod-menu-dynatree").fancytree("getTree").count()?(e(".meliscms-search-box.sidebar-treeview-search").hide(),e.get("/melis/MelisCms/TreeSites/checkUserPageTreeAccress",{idPage:-1},function(t){t.isAccessible&&e("#id-mod-menu-dynatree").prepend("<div class='create-newpage'><span class='btn btn-success'>"+translations.tr_meliscms_create_page+"</span></div>")})):(e(".meliscms-search-box.sidebar-treeview-search").show(),e("#id-mod-menu-dynatree .create-newpage").remove())},click:function(t,i){if(targetType=i.targetType,"title"===targetType&&(i.node.setExpanded(),melisCore.screenSize<=1024)){var s=(i=i.node.data).melisData.page_id+" - "+i.melisData.page_title;melisHelper.tabOpen(s,i.iconTab,i.melisData.item_zoneid,i.melisData.item_melisKey,{idPage:i.melisData.page_id},null,melisCms.pageTabOpenCallback(i.melisData.page_id))}e(".hasNiceScroll").getNiceScroll().resize(),a.length&&a.removeClass("hide-arrow")},dblclick:function(t,i){var a=(i=i.node.data).melisData.page_id+" - "+i.melisData.page_title;return melisHelper.tabOpen(a,i.iconTab,i.melisData.item_zoneid,i.melisData.item_melisKey,{idPage:i.melisData.page_id},null,melisCms.pageTabOpenCallback(i.melisData.page_id)),e(".hasNiceScroll").getNiceScroll().resize(),!1},loadChildren:function(t,i){e("#id-mod-menu-dynatree").fancytree("getTree")},renderNode:function(t,i){e(i.node.span).find(".fancytree-icon").addClass(i.node.data.iconTab).removeClass("fancytree-icon"),"loading"!==i.node.statusNodeType&&(0===i.node.data.melisData.page_is_online&&e(i.node.span).find(".fancytree-title, .fa").css("color","#686868"),1===i.node.data.melisData.page_has_saved_version&&0==e(i.node.span).children("span").hasClass("unpublish")&&e(i.node.span).find(".fancytree-title").before("<span class='unpublish'></span>"))},dnd:{autoExpandMS:400,smartRevert:!0,refreshPositions:!0,draggable:{zIndex:1e3,scroll:!1,appendTo:"body"},dragStart:function(t,i){var a=e("#leftLockDragDropTreeView .fa-lock").length;return melisCore.screenSize>=1024&&0===a&&!!i.node.data.dragdrop},dragEnter:function(e,t){return!0},dragOver:function(e,t){},dragLeave:function(e,t){},dragStop:function(e,t){},dragDrop:function(t,i){t.setExpanded(!0).always(function(){var a=i.otherNode.getParent().key.toString().includes("root")?-1:i.otherNode.getParent().key;i.otherNode.moveTo(t,i.hitMode);e("#id-mod-menu-dynatree").fancytree("getTree");var s=i.otherNode.key,n=t.getParent().key.toString().includes("root")?-1:t.getParent().key;"over"==i.hitMode&&(n=i.node.key);var o={idPage:s,oldFatherIdPage:a,newFatherIdPage:n,newPositionIdPage:i.otherNode.getIndex()+1};e.ajax({url:"/melis/MelisCms/Page/movePage",data:o,encode:!0}).done(function(e){}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})}}})},mainTree()}),a.on("click","#id-mod-menu-dynatree .create-newpage .btn",function(){melisHelper.tabOpen(translations.tr_meliscms_page_creation,"fa-file-text-o","0_id_meliscms_page","meliscms_page_creation",{idPage:0,idFatherPage:"-1"})}),a.on("click","#sourcePageIdFindPageTree span",function(){melisLinkTree.createInputTreeModal("#sourcePageId")}),a.on("click","#destinationPageIdFindPageTree span",function(){melisLinkTree.createInputTreeModal("#destinationPageId")}),a.on("click",'button[data-inputid="#destinationPageId"]',function(){e('[name="use_root"]').each(function(){e(this).is(":checked")&&e(this).prop("checked",!1)}),e(".remember-me-cont .cbmask-inner").removeClass("cb-active"),e("#destinationPageId").prop("disabled",!1)}),a.on("change",'[name="use_root"]',function(){e('[name="use_root"]:checked').length?(e("#destinationPageId").val(""),e("#destinationPageId").prop("disabled",!0)):e("#destinationPageId").prop("disabled",!1)}),t.treeCallBack=function(){0==e("#id-mod-menu-dynatree").children().length&&mainTree()},a.on("click","#duplicatePageTree",function(){var t=e("#duplicatePageTreeForm").serializeArray(),i=e('#duplicatePageTreeForm input[name="destinationPageId"]').val();melisCoreTool.pending("#duplicatePageTree"),e("#duplicatePageTree").find("i").removeClass(),e("#duplicatePageTree").find("i").addClass("fa fa-spinner fa-spin"),e.ajax({type:"POST",url:"/melis/MelisCms/TreeSites/duplicateTreePage",data:t,dataType:"json",encode:!0}).done(function(t){t.success?(e("#id_meliscms_tools_tree_modal_form_handler_container").modal("hide"),melisCms.refreshTreeview(i,1),melisHelper.melisOkNotification(t.textTitle,t.textMessage)):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,"stylesForm")),melisCore.flashMessenger(),melisCoreTool.done("#duplicatePageTree"),e("#duplicatePageTree").find("i").removeClass(),e("#duplicatePageTree").find("i").addClass("fa fa-save")}).fail(function(){alert(translations.tr_meliscore_error_message)})})}(jQuery,window),$(document).ready(function(){var e=$("body");e.on("click",".btnEditTemplates",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.hideAlert("#templateupdateformalert"),melisCoreTool.showOnlyTab("#modal-template-manager-actions","#id_modal_tool_template_edit"),toolTemplate.retrieveTemplateData(e)}),e.on("click",".btnDelTemplate",function(){var e=$(this).parents("tr").attr("id");toolTemplate.deleteTemplate(e)}),e.on("click","#id_meliscms_tool_templates_header_add",function(){melisCoreTool.hideAlert("#templateaddformalert"),melisCoreTool.resetLabels("#id_modal_tool_template_add #id_tool_template_generic_form")}),e.on("click","#btnTemplateUpdate",function(){toolTemplate.updateTemplate()}),e.on("click",".btnMelisTemplatesExport",function(){var e=$("input[type='search'][aria-controls='tableToolTemplateManager']").val(),t=$("#templatesSiteSelect").val();melisCoreTool.isTableEmpty("tableToolTemplateManager")||melisCoreTool.exportData("/melis/MelisCms/ToolTemplate/exportToCsv?filter="+e+"&site="+t)}),e.on("change","#templatesSiteSelect",function(){var e=$(this).parents().eq(6).find("table").attr("id");$("#"+e).DataTable().ajax.reload()})});var toolTemplate={table:function(){return"#tableToolTemplate"},initTool:function(){melisCoreTool.initTable(toolTemplate.table())},refreshTable:function(){melisCoreTool.switchTab("#id_modal_tool_template_add"),melisHelper.zoneReload("id_meliscms_tool_templates","meliscms_tool_templates")},addNewTemplate:function(){var e=$("#id_modal_tool_template_add #id_tool_template_generic_form").serialize();melisCoreTool.pending("#btnTemplateAdd"),$.ajax({type:"POST",url:"/melis/MelisCms/ToolTemplate/newTemplateData",data:e,dataType:"json",encode:!0}).done(function(e){e.success?($("#modal-template-manager-actions").modal("hide"),toolTemplate.refreshTable(),melisCoreTool.clearForm("id_tool_template_generic_form"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#templateaddformalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_modal_tool_template_add #id_tool_template_generic_form")),melisCore.flashMessenger(),melisCoreTool.done("#btnTemplateAdd")}).fail(function(){alert(translations.tr_meliscore_error_message)})},updateTemplate:function(){var e=$("#id_modal_tool_template_edit #id_tool_template_generic_form").serializeArray();e.push({name:"tpl_id",value:$("#tplid").html()}),e=$.param(e),melisCoreTool.resetLabels("#id_modal_tool_template_edit #id_tool_template_generic_form"),melisCoreTool.pending("#btnTemplateEdit"),$.ajax({type:"POST",url:"/melis/MelisCms/ToolTemplate/updateTemplateData",data:e,dataType:"json",encode:!0}).done(function(e){e.success?($("#modal-template-manager-actions").modal("hide"),toolTemplate.refreshTable(),melisCoreTool.clearForm("id_tool_template_generic_form"),melisCoreTool.resetLabels("#id_tool_template_generic_form"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#templateupdateformalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"id_tool_template_generic_form")),melisCore.flashMessenger(),melisCoreTool.done("#btnTemplateEdit")}).fail(function(){alert(translations.tr_meliscore_error_message)})},retrieveTemplateData:function(e){var t="#id_modal_tool_template_edit form#id_tool_template_generic_form ";melisCoreTool.resetLabels(t),$.ajax({type:"POST",url:"/melis/MelisCms/ToolTemplate/getTemplateDataById",data:{templateId:e},dataType:"json",encode:!0}).done(function(e){$.each(e,function(e,i){if($(t+" input, "+t+" select").each(function(e){var a=$(this).attr("name");$(t+" #"+$(this).attr("id")).val(i[a]),$("#tplid").html(i.tpl_id)}),i.tpl_type_KO){var a=$("#id_modal_tool_template_edit #tpl-type-error");a.show(),a.parent("label").css("color","rgb(255, 0, 0)")}})}).fail(function(){alert(translations.tr_meliscore_error_message)})},deleteTemplate:function(e){melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_tool_template_fm_delete_title,translations.tr_tool_template_fm_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCms/ToolTemplate/deleteTemplateData",data:{templateId:e},dataType:"json",encode:!0}).done(function(e){melisCoreTool.pending(".delTemplate"),e.success&&(toolTemplate.refreshTable(),melisCore.flashMessenger(),melisHelper.melisOkNotification(e.textTitle,e.textMessage)),melisCoreTool.done(".delTemplate")}).fail(function(){alert(translations.tr_meliscore_error_message)})})}};window.initTemplateList=function(e,t){var i=$("#templatesSiteSelect");i.length&&(e.tpl_site_id=i.val())},$(function(){var e="#formplatformedit form#idformlang";function t(e,t){$("body").on("click",e,t)}t("#btn_cms_new_lang",function(){melisCoreTool.showOnlyTab("#modal-language-cms","#id_meliscms_tool_language_modal_content_new"),melisCoreTool.clearForm("idformlang")}),t("#btnLangCmsAdd",function(){var e=$(this).parent().find("#idformlang").serialize();melisCoreTool.pending("#btnLangCmsAdd"),melisCoreTool.processing(),$.ajax({type:"POST",url:"/melis/MelisCms/Language/addLanguage",data:e,dataType:"json",encode:!0}).done(function(e){e.success?($("#modal-language-cms").modal("hide"),melisHelper.zoneReload("id_meliscms_tool_language","meliscms_tool_language"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#languagealert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"idformlang")),melisCoreTool.done("#btnLangCmsAdd"),melisCore.flashMessenger(),melisCoreTool.processDone()}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}),t("#btnLangCmsEdit",function(){melisCoreTool.showOnlyTab("#modal-language-cms","#id_meliscms_tool_language_modal_content_edit");var t=$(this).parents("tr").attr("id");$.ajax({type:"POST",url:"/melis/MelisCms/Language/getLanguageById",data:{id:t},dataType:"json",encode:!0}).done(function(t){melisCoreTool.pending(".btn"),$(e+" input[type='text']").each(function(e){var i=$(this).attr("name");$("input#"+$(this).attr("id")).val(t.language[i]),$("span#platformupdateid").html(t.language.lang_cms_id)}),melisCoreTool.done(".btn")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}),t("#btnLangEdit",function(){var t=$(e).serializeArray();t.push({name:"id",value:$("#platformupdateid").html()}),t=$.param(t),melisCoreTool.pending("#btnLangEdit"),melisCoreTool.processing(),$.ajax({type:"POST",url:"/melis/MelisCms/Language/editLanguage",data:t,dataType:"json",encode:!0}).done(function(e){e.success?($("#modal-language-cms").modal("hide"),melisHelper.zoneReload("id_meliscms_tool_language","meliscms_tool_language"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#langeditalert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCoreTool.highlightErrors(e.success,e.errors,"formplatformedit form#idformlang")),melisCoreTool.done("#btnLangEdit"),melisCore.flashMessenger(),melisCoreTool.processDone()}).fail(function(){alert(translations.tr_meliscore_error_message)})}),t("#btnLangCmsDelete",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.confirm(translations.tr_meliscms_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscms_tool_language,translations.tr_meliscms_tool_language_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCms/Language/deleteLanguage",data:{id:e},dataType:"json",encode:!0}).done(function(e){melisCoreTool.pending(".btn-danger"),e.success?(melisHelper.zoneReload("id_meliscms_tool_language_content","meliscms_tool_language_content"),melisHelper.zoneReload("id_meliscms_header_language","meliscms_header_language"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger(),melisCoreTool.done(".btn-danger")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})})}),window.initLangJs=function(){$('#tableLanguages td:nth-child(3):contains("'+melisLangId+'")').siblings(":last").html("-")},$(function(){var e=$("body");e.on("click",".btnCmsPlatfomEdit",function(){var e=$(this).parents("tr").attr("id");modalId="platform_tool_modal",platform_modal_content="meliscms_tool_platform_ids_modal_content",modalUrl="/melis/MelisCms/Platform/renderPlatformModal",melisHelper.createModal(modalId,platform_modal_content,!1,{id:e},modalUrl)}),e.on("click",".btnSavePlatfomrRange",function(){var e=$(this).data("id"),t=$("#idformplatform").serializeArray();t.push({name:"pids_id",value:e}),t=$.param(t),$("#cmsPlatformAlert").addClass("hidden"),$.ajax({type:"POST",url:"/melis/MelisCms/Platform/savePlatformIdsRange",data:t,dataType:"json",encode:!0}).done(function(e){e.success?($("#platform_tool_modal_container").modal("hide"),melisHelper.zoneReload("id_meliscms_tool_platform_ids","meliscms_tool_platform_ids"),melisHelper.melisOkNotification(e.textTitle,e.textMessage)):(melisCoreTool.alertDanger("#cmsPlatformAlert","",e.textMessage),melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors)),melisCore.flashMessenger(),melisCoreTool.highlightErrors(e.success,e.errors,"idformplatform")}).fail(function(e,t,i){alert("ERROR !! Status = "+t+"\n Error = "+i+"\n xhr = "+e.statusText)})}),e.on("click","#id_meliscms_tool_platform_ids_add_button",function(){modalId="platform_tool_modal",platform_modal_content="meliscms_tool_platform_ids_modal_content",modalUrl="/melis/MelisCms/Platform/renderPlatformModal",melisHelper.createModal(modalId,platform_modal_content,!1,null,modalUrl)}),e.on("click",".btnCmsPlatformIdsDelete",function(){var e=$(this).parents("tr").attr("id"),t=new Array;t.push({name:"pid_id",value:e}),melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscms_tool_platform_ids,translations.tr_meliscms_tool_platform_ids_confirm_msg,function(){$.ajax({type:"POST",url:"/melis/MelisCms/Platform/deletePlatformId",data:t,dataType:"json",encode:!0}).done(function(e){melisHelper.zoneReload("id_meliscms_tool_platform_ids","meliscms_tool_platform_ids"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisCore.flashMessenger()}).fail(function(){alert(translations.tr_meliscore_error_message)})})}),window.initPlatformIdTbl=function(){$("#platformToolTable").find(".noPlatformIdDeleteBtn").each(function(){var e="#"+$(this).attr("id");$("#platformToolTable").find(e).find(".btnCmsPlatformIdsDelete").remove()})}}),$(function(){var e=$("body");e.on("click",".addRedirectSite",function(){var e=$(this).data("s301id");createSite301Modal(e)}),e.on("click",".editRedirectSite",function(){var e=$(this).parents("tr").attr("id");createSite301Modal(e)}),e.on("click",".saveSiteRedirect",function(){$(this).data("s301id");var e=new Array;e=$("#siteRedirectForm").serializeArray(),$.ajax({type:"POST",url:"/melis/MelisCms/SiteRedirect/saveSiteRedirect",data:e,dataType:"json",encode:!0}).done(function(e){e.success?($("#id_meliscms_tool_site_301_generic_form_container").modal("hide"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscms_tool_site_301_content","meliscms_tool_site_301_content")):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger(),melisCoreTool.highlightErrors(e.success,e.errors,"siteRedirectForm")}).fail(function(){alert(translations.tr_meliscore_error_message)})}),e.on("click",".deleteRedirectSite",function(){var e=$(this).parents("tr").attr("id");melisCoreTool.confirm(translations.tr_meliscms_common_yes,translations.tr_meliscms_common_no,translations.tr_meliscms_tool_site_301_delete_site_redirect,translations.meliscms_tool_site_301_delete_confirm_msg,function(){$.ajax({type:"POST",url:"/melis/MelisCms/SiteRedirect/deleteSiteRedirect",data:{s301Id:e},dataType:"json",encode:!0}).done(function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisHelper.zoneReload("id_meliscms_tool_site_301_content","meliscms_tool_site_301_content")):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()}).fail(function(){alert(translations.tr_meliscore_error_message)})})}),e.on("click",".testRedirectSite",function(){var e=$(this).parents("tr").attr("id"),t=$("#tableToolSite301 tr#"+e+" td:nth-child(4)").text();""!==t?window.open(t,"_blank"):alert(translations.tr_meliscore_error_message)}),e.on("change","#redirectSiteSelect",function(){var e=$(this).parents().eq(6).find("table").attr("id");$("#"+e).DataTable().ajax.reload()})}),window.createSite301Modal=function(e){void 0===e&&(e=null),zoneId="id_meliscms_tool_site_301_generic_form",melisKey="meliscms_tool_site_301_generic_form",modalUrl="/melis/MelisCms/SiteRedirect/renderToolSiteRedirectModal",melisHelper.createModal(zoneId,melisKey,!1,{s301Id:e},modalUrl)},window.initRedirectTemplateList=function(e,t){$("#redirectSiteSelect").length&&(e.s301_site_id=$("#redirectSiteSelect").val())};var melisLinkTree=function(e,t){var i=e("body");function a(){var t=e("input[name=tree_search]").val(),i=e("#find-page-dynatree").fancytree("getTree"),a=i.filterNodes,s={};i.clearFilter(),e("#find-page-dynatree").fancytree("getRootNode").visit(function(e){e.resetLazy()}),e("input[name=tree_search]").prop("disabled",!0);var n=e("input[name=tree_search]").closest(".meliscms-search-box");n.addClass("searching"),e.ajax({type:"POST",url:"melis/MelisCms/Page/searchTreePages",data:{name:"value",value:t},dataType:"json",encode:!0}).done(function(o){if(e.trim(o)){var r=e.map(o,function(e){return e});i.loadKeyPath(r,function(e,n){if(!e.isVisible())switch(n){case"loaded":case"ok":e.makeVisible()}a.call(i,t,s)}).done(function(){e("input[name=tree_search]").prop("disabled",!1),n.removeClass("searching")})}else n.append("<div class='melis-search-overlay'>Not Found</div>").hide().fadeIn(600),setTimeout(function(){e(".melis-search-overlay").fadeOut(600,function(){e(this).remove()}),e("input[name=tree_search]").prop("disabled",!1),e("input[name=tree_search]").focus()},1e3)}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}function s(i){var a=e("body"),s=a.find(".tox-dialog"),n=a.find("#mce-link-tree"),o=t.parent.$(".melis-iframe"),r=o.contents().find(".tox-dialog"),l=o.contents().find("#mce-link-tree");r.length&&l.parent().find("input").val(i),s.length&&n.parent().find("input").val(i)}function n(){zoneId="id_meliscms_find_page_tree",melisKey="meliscms_find_page_tree",modalUrl="melis/MelisCms/Page/renderPageModal",e("#id_meliscms_find_page_tree_container").length&&e("#id_meliscms_find_page_tree_container").parent().remove(),t.parent.melisHelper.createModal(zoneId,melisKey,!1,{},modalUrl,function(){}),e("#mce-link-tree").closest(".tox-dialog").css("z-index",1049),e(".tox-tinymce-aux").css("z-index",1048),e(".tox-tinymce-aux").find(".tox-dialog-wrap__backdrop").css("z-index",1047)}return i.on("click","#mce-link-tree",n),e(document).on("keyup","input[name=tree_search]",function(e){"13"==(e.keyCode?e.keyCode:e.which)&&a()}).focus(),i.on("click","#searchTreeView",function(e){a()}),i.on("click","#resetTreeView",function(t){melisHelper.loadingZone(e(".page-evolution-content")),e("input[name=tree_search]").val(""),e("#find-page-dynatree").fancytree("getTree").clearFilter(),e("#find-page-dynatree").fancytree("getRootNode").visit(function(e){e.setExpanded(!1)}),setTimeout(function(){melisHelper.removeLoadingZone(e(".page-evolution-content"))},2e3)}),i.on("click","#generateTreePageLink",function(){melisCoreTool.pending("#generateTreePageLink");var t=e("#find-page-dynatree .fancytree-active").parent("li").attr("id").split("_")[1];e.ajax({type:"GET",url:"melis/MelisCms/Page/getPageLink",data:{idPage:t},dataType:"json",encode:!0}).done(function(t){s(t.link),e("#id_meliscms_find_page_tree_container").modal("hide")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)}),melisCoreTool.done("#generateTreePageLink")}),i.on("click","#generateTreePageId",function(){melisCoreTool.pending("#generateTreePageLink");var t=e("#find-page-dynatree .fancytree-active").parent("li").attr("id").split("_")[1],i=e("#generateTreePageId").data("inputid");e(i).val(t),e("#id_meliscms_input_page_tree_container").modal("hide"),melisCoreTool.done("#generateTreePageLink")}),{createTreeModal:n,createInputTreeModal:function(i){zoneId="id_meliscms_input_page_tree",melisKey="meliscms_input_page_tree",modalUrl="melis/MelisCms/Page/renderPageModal",e("#id_meliscms_input_page_tree_container").length&&e("#id_meliscms_input_page_tree_container").parent().remove(),t.parent.melisHelper.createModal(zoneId,melisKey,!1,{pageTreeInputId:i},modalUrl,function(){})},findPageMainTree:function(){e("#find-page-dynatree").fancytree({extensions:["filter"],keyboard:!0,generateIds:!0,idPrefix:"pageid_",source:{url:"/melis/MelisCms/TreeSites/get-tree-pages-by-page-id",cache:!0},lazyLoad:function(e,t){var i=t.node.data.melisData.page_id;t.result={url:"/melis/MelisCms/TreeSites/get-tree-pages-by-page-id?nodeId="+i,data:{mode:"children",parent:t.node.key},cache:!1}},renderNode:function(t,i){e(i.node.span).find(".fancytree-icon").addClass(i.node.data.iconTab).removeClass("fancytree-icon"),"loading"!==i.node.statusNodeType&&(i.node.data.melisData.page_is_online,1===i.node.data.melisData.page_has_saved_version&&0==e(i.node.span).children("span").hasClass("unpublish")&&e(i.node.span).find(".fancytree-title").before("<span class='unpublish'></span>"))},filter:{autoApply:!0,autoExpand:!1,counter:!0,fuzzy:!1,hideExpandedCounter:!0,hideExpanders:!1,highlight:!0,leavesOnly:!1,nodata:!0,mode:"hide"}})},checkBtn:function(){i.find(".mce-has-open").prev().text(),i.find(".mce-has-open")[0],i.find(".mce-widget.mce-label").each(function(){if("Url"===e(this).text()){var t,a=i.find(".mce-btn.mce-open"),s=a.width()+1,n=e(this).next(),o=n.children(".mce-textbox");a.length?(t=o.width()-s,a.css({left:"0"}),o.css({width:t}),i.find(".mce-has-open").append('<div id="mce-link-tree" class="mce-btn mce-open" style="position: absolute; right: 0; width: 32px; height: 28px;"><button><i class="icon icon-sitemap fa fa-sitemap" style="font-family: FontAwesome; position: relative; top: 2px; font-size: 16px;"></i></button></div>')):(t=o.width()-32,o.css({width:t}),n.append('<div id="mce-link-tree" class="mce-btn mce-open" style="position: absolute; right: 0; width: 32px; height: 28px;"><button><i class="icon icon-sitemap fa fa-sitemap" style="font-family: FontAwesome; position: relative; top: 2px; font-size: 16px;"></i></button></div>'))}})},showUrl:s}}(jQuery,window);$(function(){$("body").on("click","a.melis-pageduplicate",function(){var e=$(this).data().pagenumber;$.ajax({type:"POST",url:"/melis/MelisCms/PageDuplication/duplicate-page",data:{id:e},dataType:"json",encode:!0}).done(function(e){if(e.success){if(melisCms.refreshTreeview(e.response.pageId),e.response.openPageAfterDuplicate){var t=e.response.pageId+" - "+e.response.name;melisHelper.tabOpen(t,e.response.icon,e.response.pageId+"_id_meliscms_page","meliscms_page",{idPage:e.response.pageId})}melisHelper.melisOkNotification(e.textTitle,e.textMessage)}else melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,0);melisCore.flashMessenger()}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})});var melisSearchPageTree=function(e,t){var i=e("body");function a(){var t=e.trim(e("input[name=left_tree_search]").val()),i=e("#id-mod-menu-dynatree").fancytree("getTree"),a=i.filterNodes;if(t.length){var s={};e(".meliscms-search-box.sidebar-treeview-search").append("<div class='melis-overlay-loading'></div>"),i.clearFilter(),e("#id-mod-menu-dynatree").fancytree("getRootNode").visit(function(e){e.isExpanded()&&e.resetLazy()}),e("input[name=left_tree_search]").prop("disabled",!0);var n=e("input[name=left_tree_search]").closest(".meliscms-search-box");e.ajax({type:"POST",url:"melis/MelisCms/Page/searchTreePages",data:{name:"value",value:t},dataType:"json",encode:!0}).done(function(o){if(e.trim(o)){var r=e.map(o,function(e){return e});i.loadKeyPath(r,function(e,n){switch(n){case"loaded":case"ok":e.makeVisible()}a.call(i,t,s)}).done(function(){e("input[name=left_tree_search]").prop("disabled",!1),e(".meliscms-search-box.sidebar-treeview-search .melis-overlay-loading").remove(),e("input[name=left_tree_search]").focus()})}else n.append("<div class='melis-search-overlay'>"+translations.tr_meliscms_form_search_not_found+"</div>").hide().fadeIn(600),setTimeout(function(){e(".melis-search-overlay").fadeOut(600,function(){e(this).remove()}),e("input[name=left_tree_search]").prop("disabled",!1),e("input[name=left_tree_search]").focus(),e(".meliscms-search-box.sidebar-treeview-search .melis-overlay-loading").remove()},1e3)}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}}i.on("click","#leftSearchTreeView",function(e){a()}),i.on("click","#leftLockDragDropTreeView",function(){var t,i=e(this),a=e("#leftResetTreeView"),s=i.find(".fa.fa-lock"),n=i.find(".fa.fa-unlock");a.trigger("click"),s.length&&(s.removeClass("fa-lock").addClass("fa-unlock"),i.attr("title",translations.tr_meliscms_menu_treeview_page_unlock),t=setInterval(function(){var i=e("#leftLockDragDropTreeView"),a=i.find(".fa.fa-unlock");a.length&&(setTimeout(function(){a.removeClass("fa-unlock").addClass("fa-lock"),i.attr("title",translations.tr_meliscms_menu_treeview_page_lock)},3e5),clearInterval(t))},3e4)),n.length&&(n.removeClass("fa-unlock").addClass("fa-lock"),i.attr("title",translations.tr_meliscms_menu_treeview_page_lock))}),e(document).on("keyup","input[name=left_tree_search]",function(e){"13"==(e.keyCode?e.keyCode:e.which)&&a()}),i.on("click","#leftResetTreeView",function(t){e("input[name=left_tree_search]").val(""),e("#id-mod-menu-dynatree").fancytree("destroy"),mainTree()}),e("#leftLockDragDropTreeView").attr("title",translations.tr_meliscms_menu_treeview_page_lock)}(jQuery,window);$(function(){var e=$("body");e.on("click",".pageLangCreate",function(){var e=$(this),t=e.data("pageid"),i=e.data("formid"),a=$("#"+i).serializeArray();e.attr("disabled",!0),$.ajax({type:"POST",url:"/melis/MelisCms/PageLanguages/createNewPageLangVersion",data:a,dataType:"json",encode:!0}).done(function(a){a.success?($.isEmptyObject(a.pageInfo)||(melisHelper.tabOpen(a.pageInfo.name,a.pageInfo.tabicon,a.pageInfo.id,a.pageInfo.meliskey,{idPage:a.pageInfo.pageid}),melisCms.refreshTreeview(a.pageInfo.pageid)),melisHelper.zoneReload(t+"_id_meliscms_page","meliscms_page",{idPage:t}),melisHelper.melisOkNotification(a.textTitle,a.textMessage)):(melisCoreTool.alertDanger("#cmsPlatformAlert","",a.textMessage),melisHelper.melisKoNotification(a.textTitle,a.textMessage,a.errors)),melisCore.flashMessenger(),melisCoreTool.highlightErrors(a.success,a.errors,i),e.attr("disabled",!1)}).fail(function(t,i,a){e.attr("disabled",!1),alert(translations.tr_meliscore_error_message)})}),e.on("click",".open-page-from-lan-tab",function(){var e=$(this).data();$.isEmptyObject(e)||melisHelper.tabOpen(e.name,e.tabicon,e.id,e.meliskey,{idPage:e.pageid})})}),$(function(){var e=$("body");e.on("click","#id_meliscms_tool_styles_header_add",function(){melisStyleTool.openToolModal(0)}),e.on("click",".btnEditStyles",function(){var e=$(this).closest("tr").attr("id");melisStyleTool.openToolModal(e)}),e.on("click","#saveStyleDetails",function(){$(this).data("style-id");var e=$("#stylesForm").serializeArray();melisStyleTool.saveStyleDetails(e)}),e.on("click",".btnDelStyle",function(){var e=$(this).closest("tr").attr("id");melisStyleTool.deleteStyle(e)}),e.on("click","#styleInputFindPageTree span",function(){melisLinkTree.createInputTreeModal("#id_style_page_id")})});var melisStyleTool=function(e,t){return{openToolModal:function(e){zoneId="id_meliscms_tool_styles_modal_form_handler",melisKey="meliscms_tool_styles_modal_form_handler",modalUrl="melis/MelisCms/ToolStyle/renderToolStyleModalContainer",melisHelper.createModal(zoneId,melisKey,!1,{styleId:e},modalUrl,function(){})},saveStyleDetails:function(t){melisCoreTool.pending("#saveStyleDetails"),e.ajax({type:"POST",url:"/melis/MelisCms/ToolStyle/saveStyleDetails",data:t,dataType:"json",encode:!0}).done(function(t){t.success?(e("#id_meliscms_tool_styles_modal_form_handler_container").modal("hide"),melisStyleTool.refreshTable(),melisHelper.melisOkNotification(t.textTitle,t.textMessage)):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(t.success,t.errors,"stylesForm")),melisCore.flashMessenger(),melisCoreTool.done("#saveStyleDetails")}).fail(function(){alert(translations.tr_meliscore_error_message)})},deleteStyle:function(t){var i={styleId:t};melisCoreTool.pending(".btnDelStyle"),melisCoreTool.confirm(translations.tr_meliscms_common_yes,translations.tr_meliscms_common_no,translations.tr_meliscms_tool_styles_delete_title,translations.tr_meliscms_tool_styles_delete_details,function(){e.ajax({type:"POST",url:"/melis/MelisCms/ToolStyle/deleteStyle",data:i,dataType:"json",encode:!0}).done(function(e){melisCoreTool.done(".btnDelStyle"),e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage),melisStyleTool.refreshTable()):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger()}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})},refreshTable:function(){melisHelper.zoneReload("id_meliscms_tool_styles_content","meliscms_tool_styles_content")}}}(jQuery,window);$(function(){var e=$("body");e.on("change","#id_mcgdprbanner_site_id",function(){melisCoreTool.highlightErrors(1,null,"id_melis_cms_gdpr_banner_header"),melisHelper.zoneReload("id_melis_cms_gdpr_banner_details","melis_cms_gdpr_banner_details",{siteId:this.value}),this.value>0?e.find(".cms-gdpr-save").show():e.find(".cms-gdpr-save").hide()}),e.on("click",".cms-gdpr-save",function(){if(void 0===e.find(this).attr("disabled")){melisCoreTool.pending(".cms-gdpr-save");var t={},i=[],a=e.find("#cms_gdpr_banner_site_filter_form");a.length>0&&(t.filters={siteId:a.serializeArray()}),e.find(".mcms-gdpr-banner-language").each(function(t,a){i.push(e.find(a).data("langId"))});for(var s=[],n={},o=0;o<i.length;o++)(s=e.find("#id-cms-gdpr-banner-content-form-"+i[o])).length>0&&(n[i[o]]=s.serializeArray());t.bannerContent=n,$.ajax({type:"POST",url:"/melis/MelisCms/GdprBanner/saveBanner",data:t,dataType:"json",encode:!0}).done(function(t){t.success?(melisHelper.melisOkNotification(t.textTitle,t.textMessage),e.find("#id_mcgdprbanner_site_id").trigger("change")):(melisHelper.melisKoNotification(t.textTitle,t.textMessage,t.errors),melisCoreTool.highlightErrors(0,t.errors,"id_melis_cms_gdpr_banner")),melisCore.flashMessenger(),melisCoreTool.done(".cms-gdpr-save")}).fail(function(e,t,i){melisCoreTool.done(".cms-gdpr-save")})}})}),$(document).ready(function(){var e,t,i=$("body"),a="";function s(e){$(".page-export-progress prog_percent").text(e),$("div#exportImportProgressbar").attr("arial-valuenow",e).css("width",e+"%").parent().parent().removeClass("hidden")}i.on("click","#btn-export-pages",function(){var e=!0;melisCoreTool.pending("#btn-export-pages"),s(0),$(".page-export-form").addClass("hidden");var t=$("#pageExportForm").serializeArray();$.ajax({url:"/melis/MelisCms/PageExport/exportPage",data:t,type:"POST",dataType:"text",mimeType:"text/plain; charset=x-user-defined",beforeSend:function(){setTimeout(function(){s(20)},100)}}).done(function(t,a,n){var o;try{o=JSON.parse(t)}catch(i){e=!1,s(100);for(var r=n.getResponseHeader("fileName"),l=n.getResponseHeader("Content-Type"),d="",m=0;m<t.length;m++)d+=String.fromCharCode(255&t.charCodeAt(m));var c=new Uint8Array(d.length);for(m=0;m<d.length;m++)c[m]=d.charCodeAt(m);var _=new Blob([c],{type:l});saveAs(_,r),melisCore.flashMessenger(),melisHelper.melisOkNotification(translations.tr_melis_cms_tree_export_title,translations.tr_melis_cms_tree_export_notification_message,"#72af46")}e&&melisHelper.melisKoNotification(translations.tr_melis_cms_tree_export_page,"",[o.message]),i.find("#btn-export-pages").siblings("button.btn.btn-danger.pull-left").trigger("click"),melisCoreTool.done("#btn-export-pages")}).fail(function(e){melisCoreTool.done("#btn-export-pages")})}),i.on("click","#page-tree-import-test",function(){var t;melisCoreTool.pending("#page-tree-import-test"),a=i.find(".bootstrap-filestyle.input-group input").val(),(t=$("#id_meliscms_tree_sites_import_page_form")).unbind("submit"),t.on("submit",function(t){t.preventDefault();var s=new FormData(this);$.ajax({type:"POST",url:"/melis/MelisCms/PageImport/checkImportForm",data:s,cache:!1,contentType:!1,processData:!1,beforeSend:function(){i.find("#pageImportConsole").text(""),i.find("#pageImportConsole").css("display",""),i.find("#pageImportConsole").append("<p>"+translations.tr_melis_cms_page_tree_import_name_of_file+": "+a+"</p>"),i.find("#pageImportConsole").append("<p>"+translations.tr_melis_cms_page_tree_import_validated+': <span style="color: red;">'+translations.tr_meliscms_common_no+"</span></p>"),i.find("#pageImportConsole").append('<div id="pageImportProcessing"><p>'+translations.tr_melis_cms_page_tree_import_modal_processing+' <i class="fa fa-spinner fa-spin"></i></p></div>')}}).done(function(t){var a;t.success?(a=t.result,$.ajax({type:"POST",url:"/melis/MelisCms/PageImport/importTest",data:{formData:JSON.stringify(a)},beforeSend:function(){i.find("#pageImportConsole").animate({scrollTop:i.find("#pageImportConsole").get(0).scrollHeight},2e3)}}).done(function(e){if(e.success){i.find("#importPageForm").css("display","none"),i.find("#importPageValidated").css("display",""),i.find("#importPageValidated .tab-content .tab-pane").append("<p>"+translations.tr_melis_cms_page_tree_import_name_of_file+": "+a.page_tree_import.name+"</p>"),i.find("#importPageValidated .tab-content .tab-pane").append("<p>"+translations.tr_melis_cms_page_tree_import_validated+': <span style="color: green;">'+translations.tr_meliscms_common_yes+"</span></p>");var t='<button type="button" data-dismiss="modal" class="btn btn-danger pull-left">'+translations.tr_meliscms_tool_sites_cancel+"</button>",s='<button type="button" class="btn btn-success" id="page-tree-import">'+translations.tr_melis_cms_page_tree_import_file+"</button>";i.find("#importPageValidated .btn-container").append(t),i.find("#importPageValidated .btn-container").append(s)}else i.find("#pageImportConsole #pageImportProcessing").text(""),i.find("#pageImportConsole #pageImportProcessing").append("<p>"+translations.tr_melis_cms_page_tree_import_modal_processing_done+' <i style="color: green;" class="fa fa-check-circle"></i></p>'),i.find("#pageImportConsole").append('<p style="color: red;">'+translations.tr_melis_cms_page_tree_import_modal_errors+":</p>"),$.each(e.errors,function(e,t){i.find("#pageImportConsole").append('<p style="color: red;"> - '+t+"</p>")}),i.find("#pageImportConsole").animate({scrollTop:i.find("#pageImportConsole").get(0).scrollHeight},2e3);melisCoreTool.done("#page-tree-import-test")}).fail(function(e){melisCoreTool.done("#page-tree-import-test")}),e=t.result):(melisHelper.melisKoNotification(translations.tr_melis_cms_page_tree_import,"",t.errors),melisCoreTool.done("#page-tree-import-test"))}).fail(function(e){melisCoreTool.done("#page-tree-import-test")})}),t.submit()}),i.on("change","input[name=page_tree_import]",function(){var e=i.find("#page-import-max-file-size").val(),t=this.files[0].size;parseInt(t)>parseInt(e)?(melisCoreTool.pending("#page-tree-import-test"),melisHelper.melisKoNotification(translations.tr_melis_cms_page_tree_import,translations.tr_melis_cms_page_tree_error_file_size_exceeded+function(e,t){if(0===e)return"0 Bytes";const i=t<0?0:t,a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(i))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][a]}(e,2),[])):melisCoreTool.done("#page-tree-import-test")}),i.on("click","#page-tree-import",function(){var a=$(this).closest("#id_meliscms_page_import_modal").data("pageid");melisCoreTool.confirm(translations.tr_melis_cms_page_tree_import_continue_and_import,translations.tr_meliscms_tool_sites_cancel,translations.tr_melis_cms_page_tree_import_modal_are_you_sure,translations.tr_melis_cms_page_tree_import_modal_are_you_sure_content,function(){melisCoreTool.pending("#page-tree-import"),$.ajax({type:"POST",url:"/melis/MelisCms/PageImport/importPage",data:{formData:JSON.stringify(e),pageid:a},beforeSend:function(){i.find("#pageImportConsole").css("display",""),i.find("#pageImportConsole").append("<p>"+translations.tr_melis_cms_page_tree_import_name_of_file+": "+e.page_tree_import.name+"</p>"),i.find("#pageImportConsole").append("<p>"+translations.tr_melis_cms_page_tree_import_validated+': <span style="color: red;">'+translations.tr_meliscms_common_no+"</span></p>"),i.find("#pageImportConsole").append('<div id="pageImportProcessing"><p>'+translations.tr_melis_cms_page_tree_import_modal_processing+' <i class="fa fa-spinner fa-spin"></i></p></div>')}}).done(function(a){var s,n,o='<button type="button" id="importPageDoneClose" data-dismiss="modal" class="btn btn-danger pull-left" style="margin-top: -15px; margin-left: -15px;">'+translations.tr_melis_cms_page_tree_import_close+"</button>";if(i.find("#importPageValidated").css("display","none"),i.find("#importPageDone").css("display",""),a.success){t=a.idsMap,i.find("#importPageDone .tab-content .tab-pane .main-error").append("<p>"+translations.tr_melis_cms_page_tree_import_name_of_file+": "+e.page_tree_import.name+"</p>"),i.find("#importPageDone .tab-content .tab-pane .main-error").append("<p>"+translations.tr_melis_cms_page_tree_import_result+': <span style="color: green;">'+translations.tr_melis_cms_page_tree_import_success+"</span></p>"),i.find("#importPageDone .tab-content .tab-pane .main-error").append("</br>");var r=translations.tr_melis_cms_page_tree_import_modal_done+"<br/>"+a.pagesCount+translations.tr_melis_cms_page_tree_import_modal_done2_p+" "+i.find(".pageImportModal").data("pagename")+" ("+i.find(".pageImportModal").data("pageid")+")";1==a.pagesCount&&(r=translations.tr_melis_cms_page_tree_import_modal_done+"<br/>"+a.pagesCount+translations.tr_melis_cms_page_tree_import_modal_done2_s+" "+i.find(".pageImportModal").data("pagename")+" ("+i.find(".pageImportModal").data("pageid")+")"),i.find("#importPageDone .tab-content .tab-pane .main-error").append(r),i.find("#importPageDone .tab-content .tab-pane .main-error").append("</br>"),i.find("#importPageDone .tab-content .tab-pane .main-error").append("</br>"),a.keepIds?i.find("#importPageDone .tab-content .tab-pane .main-error").append('<p><i style="color:red;">NOTE : </i>'+translations.tr_melis_cms_page_tree_import_file_final_message_csv_keep_ids+"</p>"):i.find("#importPageDone .tab-content .tab-pane .main-error").append('<p><i style="color:red;">NOTE : </i>'+translations.tr_melis_cms_page_tree_import_file_final_message_csv+"</p>"),i.find("#importPageDone .btn-container").append(o),melisCore.flashMessenger(),melisHelper.melisOkNotification(translations.tr_melis_cms_page_tree_import_title,translations.tr_melis_cms_page_tree_import_notification_message,"#72af46"),s=a.firstPage,optionalArg=void 0===n?0:n,$.ajax({url:"/melis/MelisCms/TreeSites/getPageIdBreadcrumb?idPage="+s+"&includeSelf="+optionalArg,encode:!0,dataType:"json"}).done(function(e){var t=[];$.each(e,function(e,i){t.push("/"+i)}),t=(t=t.toString()).replace(/,/g,"");var i=$("#id-mod-menu-dynatree").fancytree("getTree");i.reload({url:"/melis/MelisCms/TreeSites/get-tree-pages-by-page-id"}).done(function(){i.loadKeyPath(t,function(e,t){"ok"==t&&e.setActive(!0).done(function(){e.setExpanded(!0)})}).done(function(){i.clearFilter(),!1===$("#id-mod-menu-dynatree .ui-fancytree > li:last-child").hasClass("fancytree-lastsib")&&$("#id-mod-menu-dynatree .ui-fancytree > li:last-child").remove()})})}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)}),0!=t&&$.ajax({type:"POST",url:"/melis/MelisCms/PageImport/exportCsv",data:{idsMap:t},success:function(e,t,i){if(e){var a=i.getResponseHeader("fileName"),s=i.getResponseHeader("Content-Type"),n=new Blob([i.responseText],{type:s});saveAs(n,a)}}})}else i.find("#importPageDone .tab-content .tab-pane .main-error").append("<p>"+translations.tr_melis_cms_page_tree_import_name_of_file+": "+e.page_tree_import.name+"</p>"),i.find("#importPageDone .tab-content .tab-pane .main-error").append("<p>"+translations.tr_melis_cms_page_tree_import_result+': <span style="color: red;">'+translations.tr_melis_cms_page_tree_import_failed+"</span></p>"),i.find("#importPageDone .tab-content .tab-pane .main-error").append("</br>"),i.find("#importPageDone .tab-content .tab-pane .main-error").append(translations.tr_melis_cms_page_tree_import_modal_unexpected_errors+translations.tr_melis_cms_page_tree_import_modal_unexpected_errors2+"</br>"+translations.tr_melis_cms_page_tree_import_modal_unexpected_error_detail+"</br>"),i.find("#pageImportDoneConsole").css("display",""),$.each(a.errors,function(e,t){i.find("#importPageDone #pageImportDoneConsole").append('<p style="color: red;"> - '+t+"</p>")}),i.find("#importPageDone .btn-container").append(o);melisCoreTool.done("#page-tree-import")}).fail(function(){melisCoreTool.done("#page-tree-import")})})}),i.on("click",".page-import-cont input[type=checkbox]",function(){var e=$(this);e.is(":checked")?(e.prop("checked",!0),e.prev("span").find(".cbmask-inner").addClass("cb-active")):(e.not(".requried-module").prop("checked",!1),e.parents(".page-import-cont").find(".cbmask-inner").removeClass("cb-active"))})}),$(function(){function e(e,t,i){$.ajax({type:"POST",url:"/melis/MelisCms/Sites/saveSite?siteId="+t,data:e,dataType:"json",encode:!0,beforeSend:function(){melisCoreTool.pending("#btn-save-meliscms-tool-sites")}}).done(function(e){if(1===e.success)melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),melisCore.flashMessenger(),melisCoreTool.done("#btn-save-meliscms-tool-sites"),melisHelper.zoneReload(t+"_id_meliscms_tool_sites_edit_site","meliscms_tool_sites_edit_site",{siteId:t,moduleName:i,cpath:"meliscms_tool_sites_edit_site"}),$("#tableToolSites").DataTable().ajax.reload(),$("input[name=left_tree_search]").val(""),$("#id-mod-menu-dynatree").fancytree("destroy"),mainTree();else{var a=t+"_id_meliscms_tool_sites_edit_site",s=function(e,t){var i={};return $.each(e,function(e,a){var s=$("#"+t+" #"+e),n=s.data("lang"),o=s.siblings("label").text(),r=o.substr(o.length-1),l=e.split("_");null!=n?(o=s.closest("div").siblings("label").text().slice(0,-1),i[n+" "+o]=a):""===o?(o=s.closest("div").siblings("label").text().slice(0,-2),i[o]=a):("*"===r&&(o=s.siblings("label").text().slice(0,-2)),"sdom"===l[1]&&(o="*"===r?s.siblings("label").text().slice(0,-2)+"("+l[0]+")":s.siblings("label").text()+"("+l[0]+")"),i[o]=a)}),i}(e.errors,a);!function(e,t,i){0===e||!1===e?($("#"+i+" .form-group label").css("color","#686868"),$.each(t,function(e,t){$("#"+i+" .form-control[name='"+e+"']").parents(".form-group").children("label").css("color","red")})):$("#"+i+" .form-group label").css("color","#686868")}(e.success,e.errors,a),melisHelper.melisKoNotification(e.textTitle,e.textMessage,s),melisCoreTool.done("#btn-save-meliscms-tool-sites")}melisCore.flashMessenger(),melisCoreTool.done("#btn-save-meliscms-tool-sites")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})}$body=$("body"),$body.on("click","#btn-save-meliscms-tool-sites",function(){var t=activeTabId.split("_")[0],i=$("#"+t+"_id_meliscms_tool_sites_edit_site form").serializeArray(),a=[];$.each(i,function(e,t){str1=t.name,str2="moduleLoad",-1!=str1.indexOf(str2)&&a.push(str1.replace("moduleLoad",""))});var s=$("#"+t+"_currentEnabledModule").val(),n=$("#"+t+"_sitesUsingModules").val();s=jQuery.parseJSON(s),n=jQuery.parseJSON(n);var o="";$.each(n,function(e,t){o+="<br>- "+t});var r=function(e,t){var i=[];if(null!=e&&e.length>0){for(var a=0;a<e.length;a++)t[a]!==e[a]&&i.push(e[a]);if(i.length<1)for(var a=0;a<t.length;a++)t[a]!==e[a]&&i.push(e[a])}return i}(s,a),l=$("#"+t+"_siteModuleName").val(),d=$("#not-admin-notice").length<1;r.length>0&&d?melisCoreTool.confirm(translations.tr_meliscms_common_save,translations.tr_meliscms_tool_sites_cancel,translations.tr_meliscms_tool_site_module_load_update_title,translations.tr_meliscms_tool_site_module_load_update_confirm.replace(/%s/g,o),function(){e(i=$.param(i),t,l)}):e(i=$.param(i),t,l)}),$body.on("click",".btnEditSites",function(){var e=$(this),t=e.closest("tr").attr("id"),i=e.closest("tr").find("td:nth-child(2)").text(),a=e.closest("tr").find("td:nth-child(4)").text(),s=e.closest("tr").find("td:nth-child(3)").text();b(v(e.closest("tr").attr("id"),i,s,a),t,s)});var t={},i="",a="",s=!0,n=!0,o=null,r="",l="",d="",m=[],c=!1,_="";$body.on("click","#tableToolSites .btnDeleteSite",function(e){var t=$(this).parents("tr").attr("id");melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_meliscms_tool_site_delete_confirm_title,translations.tr_meliscms_tool_site_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCms/Sites/deleteSite",data:{siteId:t},dataType:"json",encode:!0}).done(function(e){melisCoreTool.pending(".btnDeleteSite"),e.success?(melisHelper.tabClose(t+"_id_meliscms_tool_sites_edit_site"),melisHelper.melisOkNotification(e.textTitle,e.textMessage),$("#tableToolSites").DataTable().ajax.reload()):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors,0),melisCore.flashMessenger(),melisCoreTool.done(".btnDeleteSite")}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})})});var p="/melis/MelisCms/Sites/renderToolSitesModalContainer";function f(e,t){var i={},a={};return $.each(e,function(e,s){if("site_selected_lang"==this.name){var n=this.value.split("-");t=n[2],i[n[1]]=n[0]}else i[s.name]=s.value;a.data=i,a.langDetails=t}),a}function u(e){var t="";return $.each(m,function(i,a){if(a.name==e)return t=a.value}),t}function g(e){""!=e&&"skip"!=e&&$(e+" input, "+e+" select").each(function(){var e=$(this).attr("name");$(this).closest("form").find("label.err_"+e).not(":has(input)").removeClass("fieldErrorColor")})}function h(e,t){return!1===/^(www\.)?(([a-zA-Z0-9-])+\.)?(([a-zA-Z0-9-])+\.)?(([a-zA-Z0-9-])+\.)?(([a-zA-Z0-9-])+\.)?[a-zA-Z0-9\-]{1,}(\.([a-zA-Z]{2,}))$/.test(t)&&(e.addClass("fieldErrorColor"),!0)}function b(e,t,i){melisHelper.tabOpen(e,"fa-book",t+"_id_meliscms_tool_sites_edit_site","meliscms_tool_sites_edit_site",{siteId:t,moduleName:i},"id_meliscms_tool_sites",function(){$("#"+t+"_id_meliscms_tool_sites_edit_site_header site-title-tag").text(" / "+e)})}function v(e,t,i,a){return $("#tableToolSites tbody tr").each(function(){var s=$(this).find("td:nth-child(2)").text(),n=$(this).find("td:nth-child(3)").text(),o=$(this).find("td:nth-child(4)").text();a=null==a?o:a;var r=$(this).attr("id");if(e!=r&&t==s&&i==n)return t+=" - "+a}),t}function T(e){return $(e).serializeArray()}function y(e){$(e).show()}function C(e){$(e).hide()}function x(e,t,i){e.attr(t,i)}function k(e,t){e.removeAttr(t)}$body.on("click","#btn-new-meliscms-tool-sites",function(){melisCoreTool.pending("#btn-new-meliscms-tool-sites"),melisHelper.createModal("id_meliscms_tool_sites_modal_container","meliscms_tool_sites_modal_add_content",!0,[],p,function(){melisCoreTool.done("#btn-new-meliscms-tool-sites"),r=""})}),window.initializeStep=function(){o=$(".sites-steps-owl").owlCarousel({items:1,touchDrag:!1,mouseDrag:!1,dotsSpeed:500,navSpeed:500,dots:!1,pagination:!1,loop:!1,rewindNav:!1,autoHeight:!0,itemsMobile:!1,itemsTablet:!1,itemsDesktopSmall:!1,itemsDesktop:!1,afterMove:function(e){0===this.currentItem?C("#btn-prev-step"):y("#btn-prev-step")},beforeMove:function(e){var o=this.currentItem,c=e.find(".item").eq(o).attr("data-step");!function(e){var o=$("#is_multi_language").bootstrapSwitch("status");switch(e){case"step_1":r="skip",C(".step2-forms .sites_step2-multi-language"),C(".step2-forms .sites_step2-single-language");break;case"step_2":var c={};c.isMultiLang=!!o,c.data=T("#step2form-is_multi_lingual"),t.multiLang=c,o?(y(".step2-forms .sites_step2-multi-language"),C(".step2-forms .sites_step2-single-language"),r="#step2form-multi_language"):(y(".step2-forms .sites_step2-single-language"),C(".step2-forms .sites_step2-multi-language"),r="#step2form-single_language"),C(".sites_step3-single-domain"),C(".sites_step3-multi-domain"),_="";break;case"step_3":var p="";i="";var g={},h={};if(o){var b=T("#step2form-multi_language");g=f(b,p);var v=$(".sites_step3-multi-domain #multi-domains_container"),x=$("<div/>",{class:"form-group"});v.empty(),$.each(b,function(){if("site_selected_lang"==this.name){var e=this.value.split("-");p=""==p?e[2]:p+" / "+e[2];var t=$("<label/>").html(e[2]+"<sup>*</sup>").addClass("err_site-domain-"+this.value);x.append(t);var i="site-domain-"+this.value,a=$("<input/>",{type:"text",class:"form-control",name:i,value:u(i),required:"required",title:""}).attr("data-langId",e[0]);x.append(a),v.append(x)}else"sites_url_setting"==this.name&&(2==this.value?(y(".sites_step3-multi-domain"),C(".sites_step3-single-domain"),h.isMultiDomain=!0,r="#step3form-multi_domain",_=""):(y(".sites_step3-single-domain"),C(".sites_step3-multi-domain"),h.isMultiDomain=!1,r="#step3form-single_domain",1==this.value?_=" ("+translations.tr_melis_cms_sites_tool_add_step5_single_dom_opt_1_msg+")":3==this.value&&(_=" ("+translations.tr_melis_cms_sites_tool_add_step5_single_dom_opt_3_msg+")")))})}else{r="#step3form-single_domain",y(".sites_step3-single-domain"),C(".sites_step3-multi-domain"),h.isMultiDomain=!1;var k=T("#step2form-single_language");g=f(k,p),p=g.langDetails}t.languages=g.data,t.domains=h,i="- "+translations.tr_melis_cms_sites_tool_add_header_title_lang+" : "+p,C(".step-4-datas");break;case"step_4":y(".step-4-datas"),r="#step4form_module";var w="",M={};t.domains.isMultiDomain?(M=T("#step3form-multi_domain"),w="Multiple"):(M=T("#step3form-single_domain"),w="Single"+_),a="- "+translations.tr_melis_cms_sites_tool_add_header_title_domains+" : "+w,t.domains.data=function(e){var t={};return m=[],$.each(e,function(e,i){if(m.push(i),i.name.indexOf("site-domain")>=0){var a=i.name.split("-")[3];t[a]={sdom_domain:i.value}}else t[i.name]=i.value}),t}(M),y("#btn-next-step"),C("#btn-finish-step");break;case"step_5":var P={};P.data=(j=T("#step4form_module"),$.each(j,function(e,t){"create_sites_file"==t.name?(n&&(s="yes"==t.value),delete j[e]):"siteSelectModuleName"==t.name?(delete j[e],n||(j.push({site_name:t.value}),l=t.value)):"siteCreateModuleName"==t.name?(delete j[e],n&&(j.push({site_name:t.value}),l=t.value)):"site_label"==t.name&&(d=t.value)}),j),P.newSite=n,P.createFile=s,t.module=P,y("#btn-finish-step"),C("#btn-next-step");var S=translations.tr_melis_cms_sites_tool_add_step5_new_site_using_existing_module;n&&(S=translations.tr_melis_cms_sites_tool_add_step5_new_site_using_new_module);var I=S.replace(/%siteModule/g,l).replace(/%siteName/g,d);$(".site_creation_info").empty().append(i,"<br />",a,"<br/><p class='step5-message'>"+I+"</p>")}var j}(c),function(e){var t=e.split("_"),i=$("ul.create-site-step");i.find("span.step-current").text(t[1]),i.each(function(){$(this).find("li").removeClass("active")}),i.each(function(){$(this).find("li."+e).addClass("active")}),i.find("span.step-name").text(i.find("li.active").attr("data-stepName"))}(c)},afterInit:function(){$(".sites-steps-owl .tool-sites_container_fixed_width").find("label").not(":has(input)").removeClass("melis-radio-box"),setTimeout(function(){$(".sites-steps-owl .tool-sites_container_fixed_width").find("i.tip-info").attr("data-container","body")},100),c=!1,_="",r=""}})},$body.on("click","#btn-next-step",function(e){null!==o&&(""!=r&&"skip"!=r&&function(e,t){var i=[];return $.each(e,function(e,t){""!=t.value&&i.push(t.name)}),function(e,t){var i="",a="",s="",n="",r={},l=0,d=$(e+" input, "+e+" select"),m={},_=[],p=[];if($("#siteAddAlert").text(translations.tr_melis_cms_sites_tool_add_create_site_required_field).addClass("hidden"),"#step4form_module"==e&&!c)return $("#siteAddAlert").text(translations.tr_melis_cms_sites_tool_add_step4_select_module_option_err).removeClass("hidden"),!0;if(d.each(function(){if($(this).prop("required")){var e=$(this).attr("name"),o=$(this).closest("form").find("label.err_"+e).not(":has(input)");if(-1===jQuery.inArray(e,t)?(o.addClass("fieldErrorColor"),l++):o.removeClass("fieldErrorColor"),"siteCreateModuleName"==e&&(a=$(this).val(),i=$(this).closest("form").find("label.err_"+e).not(":has(input)")),"sdom_domain"==e&&(n=$(this).val(),s=$(this).closest("form").find("label.err_"+e).not(":has(input)")),-1!==e.indexOf("site-domain-")){var d=$(this).val();r[e]=d}}}),l>0)return $("#siteAddAlert").removeClass("hidden"),!0;if(""!=a&&!1===/^[A-Za-z]*$/.test(a))return i.addClass("fieldErrorColor"),$("#siteAddAlert").text(translations.tr_melis_cms_sites_tool_add_step4_create_module_error).removeClass("hidden"),!0;var f=0;return""!=n&&h(s,n)&&f++,$.each(r,function(e,t){h($("#step3form-multi_domain").find("label.err_"+e).not(":has(input)"),t)&&f++,-1===$.inArray(t,_)?(m[e]=t,_.push(t)):p.push(e)}),f>0?($("#siteAddAlert").text(translations.tr_melis_cms_sites_tool_add_step3_invalid_domain_name).removeClass("hidden"),!0):$.isEmptyObject(m)?""!=n&&($.ajax({type:"POST",url:"/melis/MelisCms/SitesDomains/checkDomain",data:{domain:n},beforeSend:function(){melisCoreTool.pending("#btn-next-step")}}).done(function(e){return $.isEmptyObject(e.result)?(o.trigger("owl.next"),melisCoreTool.done("#btn-next-step"),!1):(s.addClass("fieldErrorColor"),$("#siteAddAlert").text(translations.tr_melis_cms_sites_tool_add_step3_domain_error1+e.result[0]+translations.tr_melis_cms_sites_tool_add_step3_domain_error2),$("#siteAddAlert").removeClass("hidden"),melisCoreTool.done("#btn-next-step"),!0)}).fail(function(e,t,i){melisCoreTool.done("#btn-next-step")}),!0):0!==p.length?($.each(p,function(e,t){var i=$("#step3form-multi_domain").find("label.err_"+t).not(":has(input)");i.addClass("fieldErrorColor")}),$("#siteAddAlert").text(translations.tr_melis_cms_sites_tool_add_step3_domain_unique_error).removeClass("hidden"),!0):($.ajax({type:"POST",url:"/melis/MelisCms/SitesDomains/checkDomain",data:{domain:m},beforeSend:function(){melisCoreTool.pending("#btn-next-step")}}).done(function(e){if($.isEmptyObject(e.result))return melisCoreTool.done("#btn-next-step"),o.trigger("owl.next"),!1;$("#siteAddAlert").text("");var t=e.result.length,i=1;$.when($.each(e.result,function(e,a){var s=$("#step3form-multi_domain").find("label.err_"+e).not(":has(input)");s.addClass("fieldErrorColor");var n=s.text().slice(0,-1);$("#siteAddAlert").append(n+" - "+translations.tr_melis_cms_sites_tool_add_step3_domain_error1+a+translations.tr_melis_cms_sites_tool_add_step3_domain_error2),i!=t&&$("#siteAddAlert").append("</br>"),i++})).then(function(){return melisCoreTool.done("#btn-next-step"),$("#siteAddAlert").removeClass("hidden"),!0})}).fail(function(e,t,i){melisCoreTool.done("#btn-next-step"),alert(translations.tr_meliscore_error_message)}),!0)}(t,i)}(T(r),r)||($("#siteAddAlert").addClass("hidden"),g(r),o.trigger("owl.next")))}),$body.on("click","#btn-prev-step",function(e){null!==o&&($("#siteAddAlert").addClass("hidden"),g(r),o.trigger("owl.prev"))}),$body.on("click","#btn-finish-step",function(e){$.ajax({url:"/melis/MelisCms/Sites/createNewSite",method:"POST",data:{data:t},dataType:"JSON",beforeSend:function(){melisCoreTool.pending("#btn-finish-step")}}).done(function(e){e.success?(melisHelper.melisOkNotification(e.textTitle,e.textMessage,"#72af46"),$("#id_meliscms_tool_sites_modal_container_container").modal("hide"),t={},i="",a="",s=!0,n=!0,o=null,r="",l="",d="",m=[],c=!1,$("#tableToolSites").DataTable().ajax.reload(),$.each(e.siteIds,function(t,i){b(v(i,e.siteName,e.siteModuleName),i,e.siteModuleName)}),$("input[name=left_tree_search]").val(""),$("#id-mod-menu-dynatree").fancytree("destroy"),mainTree()):melisHelper.melisKoNotification(e.textTitle,e.textMessage,e.errors),melisCore.flashMessenger(),melisCoreTool.done("#btn-finish-step")}).fail(function(e,t,i){alert(translations.tr_melis_cms_sites_tool_add_create_site_unknown_error)}),e.preventDefault()}),$body.on("change","#is_create_new_module_for_site input[name='is_create_module']",function(){$(".step4-forms").removeClass("hidden");var e=$(this).val(),t=$("#step4form_module");"yes"==e?(n=!1,s=!1,y(t.find(".form-group.siteSelectModuleName")),C(t.find(".form-group.siteCreateModuleName")),C(t.find(".form-group.create_sites_file")),x(t.find(".form-group select[name='siteSelectModuleName']"),"required","required"),k(t.find(".form-group input[name='create_sites_file']"),"required"),k(t.find(".form-group input[name='siteCreateModuleName']"),"required")):(n=!0,y(t.find(".form-group.siteCreateModuleName")),y(t.find(".form-group.create_sites_file")),C(t.find(".form-group.siteSelectModuleName")),x(t.find(".form-group input[name='create_sites_file']"),"required","required"),x(t.find(".form-group input[name='siteCreateModuleName']"),"required","required"),k(t.find(".form-group select[name='siteSelectModuleName']"),"required")),setInterval(function(){$(".sites-steps-owl").each(function(){$(this).data("owlCarousel").autoHeight()})}),c=!0}),$body.on("keypress","#step3form-single_domain  #sdom_domain",function(e){return 13!==e.which}),$body.on("click","#s404_page_id_button span",function(){var e=$(this).closest("form").attr("id");melisLinkTree.createInputTreeModal("#"+e+" #siteprop_s404_page_id")}),$body.on("click","#site_main_page_id_button span",function(){var e=$(this).closest("form").attr("id");melisLinkTree.createInputTreeModal("#"+e+" #siteprop_site_main_page_id")}),$body.on("click",".pageSelect span.input-group-addon",function(){var e=$(this),t=e.siblings("input").attr("id"),i=e.closest("form").attr("id");melisLinkTree.createInputTreeModal("#"+i+" #"+t)}),$body.on("keypress","#meliscms_tool_sites_domain_form  input.form-control",function(e){return 13!==e.which}),$body.on("change",".sites-tool-lang-tab-checkbox",function(){var e=$(this),t=e.siblings(".sites-tool-lang-tab-checkbox-lang");"active"!==e.data("active")||this.checked?t.val("false"):melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_melis_cms_sites_tool_languages_title,translations.tr_melis_cms_sites_tool_languages_prompt_delete_data,function(){t.val("true")})}),$body.on("click",".cb-cont input[type=checkbox]",function(){$(this).is(":checked")?($(this).prop("checked",!0),$(this).prev("span").find(".cbmask-inner").addClass("cb-active")):($(this).not(".requried-module").prop("checked",!1),$(this).not(".requried-module").prev("span").find(".cbmask-inner").removeClass("cb-active"))}),$body.on("click","#step2form-multi_language .cb-cont input[type=checkbox]",function(){$(this).is(":checked")?($(this).prop("checked",!0),$(this).prev("span").find(".cbmask-inner").addClass("cb-active")):($(this).not(".requried-module").prop("checked",!1),$(this).not(".requried-module").prev("span").find(".cbmask-inner").removeClass("cb-active"))}),window.generatePageLink=function(e,t){e="undifined"!=typeof e?e:null;t.data("idPage",e),dataString=t.data(),e?$.ajax({type:"GET",url:"/melis/MelisCms/Page/getPageLink",data:dataString,dataType:"json",encode:!0}).done(function(e){t.val(e.link)}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)}):alert("PageId is null")},$body.on("click",".btnMinifyAssets",function(){var e=$(this),t=e.parents("tr").attr("id");$.ajax({type:"POST",url:"/minify-assets",data:{siteId:t},dataType:"json",encode:!0,beforeSend:function(){e.attr("disabled",!0)}}).done(function(t){if(t.success)melisHelper.melisOkNotification(t.title,"tr_front_minify_assets_compiled_successfully");else{var i="<h3>"+melisHelper.melisTranslator(t.title)+"</h3>";i+="<p><strong>Error: </strong>  ",i+="<span>"+t.message+"</span>";var a="<div class='melis-modaloverlay overlay-hideonclick'></div>";a+="<div class='melis-modal-cont KOnotif'>  <div class='modal-content'>"+(i+="</p>")+" <span class='btn btn-block btn-primary'>"+translations.tr_meliscore_notification_modal_Close+"</span></div> </div>",$body.append(a)}e.attr("disabled",!1)}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})});var w="";$body.on("click",".meliscms-site-selector",function(){zoneId="id_meliscms_page_tree_id_selector",melisKey="meliscms_page_tree_id_selector",p="melis/MelisCms/Page/renderPageModal",$("#melis-modals-container").find("#id_meliscms_page_tree_id_selector_container").remove(),w=$(this).parents(".input-group").find("input"),$("body").on("hide.bs.modal","#id_meliscms_page_tree_id_selector_container",function(){$("#id_meliscms_page_tree_id_selector_container").remove(),2==$("body").find(".modal-backdrop").length&&$("body").find(".modal-backdrop").last().remove()}),melisHelper.createModal(zoneId,melisKey,!1,{},p,function(){$.contextMenu("destroy",".fancytree-title")})}),$body.on("click","#meliscms-site-selector",function(){zoneId="id_meliscms_page_tree_id_selector",melisKey="meliscms_page_tree_id_selector",p="melis/MelisCms/Page/renderPageModal",$("#melis-modals-container").find("#id_meliscms_page_tree_id_selector_container").remove(),w=$(this).parents(".input-group").find("input"),$("body").on("hide.bs.modal","#id_meliscms_page_tree_id_selector_container",function(){$("#id_meliscms_page_tree_id_selector_container").remove(),2==$("body").find(".modal-backdrop").length&&$("body").find(".modal-backdrop").last().remove()}),melisHelper.createModal(zoneId,melisKey,!1,{},p,function(){$.contextMenu("destroy",".fancytree-title")})}),$body.on("click","#selectPageId",function(){var e=$("#find-page-dynatree .fancytree-active").parent("li").attr("id");if(void 0!==e){var t=e.split("_")[1];w.length?(w.val(t),w.data("callback")&&(callback=w.data("callback"),"function"==typeof window[callback]&&window[callback](t,w)),$(this).closest(".modal").modal("hide")):melisHelper.melisKoNotification("tr_meliscms_menu_sitetree_Name","tr_meliscore_error_message")}else melisHelper.melisKoNotification("tr_meliscms_menu_sitetree_Name","tr_meliscms_page_tree_no_selected_page")})}),window.sitesTableCallback=function(){var e=$("#tableToolSites tbody tr[data-mod-found='false']").find(".btnMinifyAssets");e.prop("disabled",!0),e.attr("disabled",!0),e.attr("title",translations.tr_melis_cms_minify_assets_no_module_button_title)},eval(function(e,t,i,a,s,n){if(s=function(e){return(e<62?"":s(parseInt(e/62)))+((e%=62)>35?String.fromCharCode(e+29):e.toString(36))},!"".replace(/^/,String)){for(;i--;)n[s(i)]=a[i]||s(i);a=[function(e){return n[e]}],s=function(){return"\\w+"},i=1}for(;i--;)a[i]&&(e=e.replace(new RegExp("\\b"+s(i)+"\\b","g"),a[i]));return e}('7(B 3i.3E!=="9"){3i.3E=9(e){9 t(){}t.5v=e;q 5c t}}(9(e,t,n,r){b i={1J:9(t,n){b r=d;r.$k=e(n);r.6=e.3K({},e.3A.2c.6,r.$k.w(),t);r.29=t;r.3U()},3U:9(){b t=d;7(B t.6.2M==="9"){t.6.2M.P(d,[t.$k])}7(B t.6.2I==="2F"){b n=t.6.2I;9 r(e){7(B t.6.3F==="9"){t.6.3F.P(d,[e])}m{b n="";1C(b r 2f e["h"]){n+=e["h"][r]["1K"]}t.$k.2h(n)}t.2Y()}e.5G(n,r)}m{t.2Y()}},2Y:9(e){b t=d;t.$k.w("h-4p",t.$k.2s("2t")).w("h-4K",t.$k.2s("J"));t.$k.A({2z:0});t.2A=t.6.v;t.4L();t.5R=0;t.1M;t.1P()},1P:9(){b e=d;7(e.$k.1S().S===0){q c}e.1O();e.3H();e.$X=e.$k.1S();e.G=e.$X.S;e.4M();e.$I=e.$k.16(".h-1K");e.$L=e.$k.16(".h-1h");e.2H="Y";e.15=0;e.1W=[0];e.p=0;e.4I();e.4G()},4G:9(){b e=d;e.2V();e.31();e.4D();e.35();e.4C();e.4A();e.2x();e.4z();7(e.6.2w!==c){e.4w(e.6.2w)}7(e.6.Q===j){e.6.Q=5i}e.1e();e.$k.16(".h-1h").A("4v","4r");7(!e.$k.2p(":33")){e.34()}m{e.$k.A("2z",1)}e.56=c;e.2o();7(B e.6.39==="9"){e.6.39.P(d,[e.$k])}},2o:9(){b e=d;7(e.6.1I===j){e.1I()}7(e.6.1A===j){e.1A()}e.4n();7(B e.6.3n==="9"){e.6.3n.P(d,[e.$k])}},3o:9(){b e=d;7(B e.6.3p==="9"){e.6.3p.P(d,[e.$k])}e.34();e.2V();e.31();e.4m();e.35();e.2o();7(B e.6.3t==="9"){e.6.3t.P(d,[e.$k])}},4i:9(e){b t=d;19(9(){t.3o()},0)},34:9(){b e=d;7(e.$k.2p(":33")===c){e.$k.A({2z:0});18(e.1r);18(e.1M)}m{q c}e.1M=4g(9(){7(e.$k.2p(":33")){e.4i();e.$k.4f({2z:1},2J);18(e.1M)}},5O)},4M:9(){b e=d;e.$X.5N(\'<M J="h-1h">\').3G(\'<M J="h-1K"></M>\');e.$k.16(".h-1h").3G(\'<M J="h-1h-4d">\');e.1U=e.$k.16(".h-1h-4d");e.$k.A("4v","4r")},1O:9(){b e=d;b t=e.$k.1V(e.6.1O);b n=e.$k.1V(e.6.28);7(!t){e.$k.K(e.6.1O)}7(!n){e.$k.K(e.6.28)}},2V:9(){b t=d;7(t.6.2Z===c){q c}7(t.6.4b===j){t.6.v=t.2A=1;t.6.17=c;t.6.1q=c;t.6.21=c;t.6.24=c;t.6.25=c;t.6.26=c;q c}b n=e(t.6.4a).1m();7(n>(t.6.1q[0]||t.2A)){t.6.v=t.2A}7(B t.6.17!=="3b"&&t.6.17!==c){t.6.17.5x(9(e,t){q e[0]-t[0]});1C(b r 2f t.6.17){7(B t.6.17[r]!=="3b"&&t.6.17[r][0]<=n){t.6.v=t.6.17[r][1]}}}m{7(n<=t.6.1q[0]&&t.6.1q!==c){t.6.v=t.6.1q[1]}7(n<=t.6.21[0]&&t.6.21!==c){t.6.v=t.6.21[1]}7(n<=t.6.24[0]&&t.6.24!==c){t.6.v=t.6.24[1]}7(n<=t.6.25[0]&&t.6.25!==c){t.6.v=t.6.25[1]}7(n<=t.6.26[0]&&t.6.26!==c){t.6.v=t.6.26[1]}}7(t.6.v>t.G&&t.6.49===j){t.6.v=t.G}},4C:9(){b n=d,r;7(n.6.2Z!==j){q c}b i=e(t).1m();n.3f=9(){7(e(t).1m()!==i){7(n.6.Q!==c){18(n.1r)}5o(r);r=19(9(){i=e(t).1m();n.3o()},n.6.48)}};e(t).47(n.3f)},4m:9(){b e=d;e.2j(e.p);7(e.6.Q!==c){e.3l()}},46:9(){b t=d;b n=0;b r=t.G-t.6.v;t.$I.2i(9(i){b s=e(d);s.A({1m:t.N}).w("h-1K",3q(i));7(i%t.6.v===0||i===r){7(!(i>r)){n+=1}}s.w("h-1L",n)})},45:9(){b e=d;b t=0;b t=e.$I.S*e.N;e.$L.A({1m:t*2,V:0});e.46()},31:9(){b e=d;e.44();e.45();e.43();e.3x()},44:9(){b e=d;e.N=1N.5a(e.$k.1m()/e.6.v)},3x:9(){b e=d;b t=(e.G*e.N-e.6.v*e.N)*-1;7(e.6.v>e.G){e.C=0;t=0;e.3D=0}m{e.C=e.G-e.6.v;e.3D=t}q t},42:9(){q 0},43:9(){b t=d;t.H=[0];t.2C=[];b n=0;b r=0;1C(b i=0;i<t.G;i++){r+=t.N;t.H.2D(-r);7(t.6.14===j){b s=e(t.$I[i]);b o=s.w("h-1L");7(o!==n){t.2C[n]=t.H[i];n=o}}}},4D:9(){b t=d;7(t.6.2b===j||t.6.1s===j){t.D=e(\'<M J="h-4R"/>\').4Q("4P",!t.F.13).5E(t.$k)}7(t.6.1s===j){t.3Z()}7(t.6.2b===j){t.3Y()}},3Y:9(){b t=d;b n=e(\'<M J="h-5h"/>\');t.D.1k(n);t.1w=e("<M/>",{"J":"h-1l",2h:t.6.2T[0]||""});t.1y=e("<M/>",{"J":"h-Y",2h:t.6.2T[1]||""});n.1k(t.1w).1k(t.1y);n.z("2W.D 1Z.D",\'M[J^="h"]\',9(e){e.1n()});n.z("2a.D 2n.D",\'M[J^="h"]\',9(n){n.1n();7(e(d).1V("h-Y")){t.Y()}m{t.1l()}})},3Z:9(){b t=d;t.1o=e(\'<M J="h-1s"/>\');t.D.1k(t.1o);t.1o.z("2a.D 2n.D",".h-1p",9(n){n.1n();7(3q(e(d).w("h-1p"))!==t.p){t.1i(3q(e(d).w("h-1p")),j)}})},3T:9(){b t=d;7(t.6.1s===c){q c}t.1o.2h("");b n=0;b r=t.G-t.G%t.6.v;1C(b i=0;i<t.G;i++){7(i%t.6.v===0){n+=1;7(r===i){b s=t.G-t.6.v}b o=e("<M/>",{"J":"h-1p"});b u=e("<3Q></3Q>",{54:t.6.38===j?n:"","J":t.6.38===j?"h-5l":""});o.1k(u);o.w("h-1p",r===i?s:i);o.w("h-1L",n);t.1o.1k(o)}}t.3a()},3a:9(){b t=d;7(t.6.1s===c){q c}t.1o.16(".h-1p").2i(9(n,r){7(e(d).w("h-1L")===e(t.$I[t.p]).w("h-1L")){t.1o.16(".h-1p").Z("2d");e(d).K("2d")}})},3d:9(){b e=d;7(e.6.2b===c){q c}7(e.6.2e===c){7(e.p===0&&e.C===0){e.1w.K("1b");e.1y.K("1b")}m 7(e.p===0&&e.C!==0){e.1w.K("1b");e.1y.Z("1b")}m 7(e.p===e.C){e.1w.Z("1b");e.1y.K("1b")}m 7(e.p!==0&&e.p!==e.C){e.1w.Z("1b");e.1y.Z("1b")}}},35:9(){b e=d;e.3T();e.3d();7(e.D){7(e.6.v>=e.G){e.D.3N()}m{e.D.3L()}}},5g:9(){b e=d;7(e.D){e.D.3j()}},Y:9(e){b t=d;7(t.1G){q c}t.p+=t.6.14===j?t.6.v:1;7(t.p>t.C+(t.6.14==j?t.6.v-1:0)){7(t.6.2e===j){t.p=0;e="2k"}m{t.p=t.C;q c}}t.1i(t.p,e)},1l:9(e){b t=d;7(t.1G){q c}7(t.6.14===j&&t.p>0&&t.p<t.6.v){t.p=0}m{t.p-=t.6.14===j?t.6.v:1}7(t.p<0){7(t.6.2e===j){t.p=t.C;e="2k"}m{t.p=0;q c}}t.1i(t.p,e)},1i:9(e,t,n){b r=d;7(r.1G){q c}7(B r.6.1F==="9"){r.6.1F.P(d,[r.$k])}7(e>=r.C){e=r.C}m 7(e<=0){e=0}r.p=r.h.p=e;7(r.6.2w!==c&&n!=="4e"&&r.6.v===1&&r.F.1u===j){r.1B(0);7(r.F.1u===j){r.1H(r.H[e])}m{r.1x(r.H[e],1)}r.2q();r.4k();q c}b i=r.H[e];7(r.F.1u===j){r.1T=c;7(t===j){r.1B("1D");19(9(){r.1T=j},r.6.1D)}m 7(t==="2k"){r.1B(r.6.2u);19(9(){r.1T=j},r.6.2u)}m{r.1B("1j");19(9(){r.1T=j},r.6.1j)}r.1H(i)}m{7(t===j){r.1x(i,r.6.1D)}m 7(t==="2k"){r.1x(i,r.6.2u)}m{r.1x(i,r.6.1j)}}r.2q()},2j:9(e){b t=d;7(B t.6.1F==="9"){t.6.1F.P(d,[t.$k])}7(e>=t.C||e===-1){e=t.C}m 7(e<=0){e=0}t.1B(0);7(t.F.1u===j){t.1H(t.H[e])}m{t.1x(t.H[e],1)}t.p=t.h.p=e;t.2q()},2q:9(){b e=d;e.1W.2D(e.p);e.15=e.h.15=e.1W[e.1W.S-2];e.1W.55(0);7(e.15!==e.p){e.3a();e.3d();e.2o();7(e.6.Q!==c){e.3l()}}7(B e.6.3z==="9"&&e.15!==e.p){e.6.3z.P(d,[e.$k])}},W:9(){b e=d;e.3k="W";18(e.1r)},3l:9(){b e=d;7(e.3k!=="W"){e.1e()}},1e:9(){b e=d;e.3k="1e";7(e.6.Q===c){q c}18(e.1r);e.1r=4g(9(){e.Y(j)},e.6.Q)},1B:9(e){b t=d;7(e==="1j"){t.$L.A(t.2y(t.6.1j))}m 7(e==="1D"){t.$L.A(t.2y(t.6.1D))}m 7(B e!=="2F"){t.$L.A(t.2y(e))}},2y:9(e){b t=d;q{"-1R-1a":"2B "+e+"1z 2r","-27-1a":"2B "+e+"1z 2r","-o-1a":"2B "+e+"1z 2r",1a:"2B "+e+"1z 2r"}},3I:9(){q{"-1R-1a":"","-27-1a":"","-o-1a":"",1a:""}},3J:9(e){q{"-1R-O":"1g("+e+"T, E, E)","-27-O":"1g("+e+"T, E, E)","-o-O":"1g("+e+"T, E, E)","-1z-O":"1g("+e+"T, E, E)",O:"1g("+e+"T, E,E)"}},1H:9(e){b t=d;t.$L.A(t.3J(e))},3M:9(e){b t=d;t.$L.A({V:e})},1x:9(e,t){b n=d;n.2g=c;n.$L.W(j,j).4f({V:e},{59:t||n.6.1j,3O:9(){n.2g=j}})},4L:9(){b e=d;b r="1g(E, E, E)",i=n.5f("M");i.2t.3P="  -27-O:"+r+"; -1z-O:"+r+"; -o-O:"+r+"; -1R-O:"+r+"; O:"+r;b s=/1g\\(E, E, E\\)/g,o=i.2t.3P.5k(s),u=o!==1d&&o.S===1;b a="5z"2f t||5C.4U;e.F={1u:u,13:a}},4A:9(){b e=d;7(e.6.22!==c||e.6.23!==c){e.3R();e.3S()}},3H:9(){b e=d;b t=["s","e","x"];e.12={};7(e.6.22===j&&e.6.23===j){t=["2W.h 1Z.h","2P.h 3V.h","2a.h 3W.h 2n.h"]}m 7(e.6.22===c&&e.6.23===j){t=["2W.h","2P.h","2a.h 3W.h"]}m 7(e.6.22===j&&e.6.23===c){t=["1Z.h","3V.h","2n.h"]}e.12["3X"]=t[0];e.12["2O"]=t[1];e.12["2N"]=t[2]},3S:9(){b t=d;t.$k.z("5A.h",9(e){e.1n()});t.$k.z("1Z.40",9(t){q e(t.1f).2p("5F, 5H, 5Q, 5S")})},3R:9(){9 o(e){7(e.2L){q{x:e.2L[0].2K,y:e.2L[0].41}}m{7(e.2K!==r){q{x:e.2K,y:e.41}}m{q{x:e.52,y:e.53}}}}9 u(t){7(t==="z"){e(n).z(i.12["2O"],f);e(n).z(i.12["2N"],l)}m 7(t==="R"){e(n).R(i.12["2O"]);e(n).R(i.12["2N"])}}9 a(n){b n=n.3B||n||t.3w;7(n.5d===3){q c}7(i.G<=i.6.v){q}7(i.2g===c&&!i.6.3v){q c}7(i.1T===c&&!i.6.3v){q c}7(i.6.Q!==c){18(i.1r)}7(i.F.13!==j&&!i.$L.1V("3s")){i.$L.K("3s")}i.11=0;i.U=0;e(d).A(i.3I());b r=e(d).2l();s.3g=r.V;s.3e=o(n).x-r.V;s.3c=o(n).y-r.5y;u("z");s.2m=c;s.30=n.1f||n.4c}9 f(r){b r=r.3B||r||t.3w;i.11=o(r).x-s.3e;i.2S=o(r).y-s.3c;i.U=i.11-s.3g;7(B i.6.2R==="9"&&s.2Q!==j&&i.U!==0){s.2Q=j;i.6.2R.P(i,[i.$k])}7(i.U>8||i.U<-8&&i.F.13===j){r.1n?r.1n():r.5M=c;s.2m=j}7((i.2S>10||i.2S<-10)&&s.2m===c){e(n).R("2P.h")}b u=9(){q i.U/5};b a=9(){q i.3D+i.U/5};i.11=1N.3x(1N.42(i.11,u()),a());7(i.F.1u===j){i.1H(i.11)}m{i.3M(i.11)}}9 l(n){b n=n.3B||n||t.3w;n.1f=n.1f||n.4c;s.2Q=c;7(i.F.13!==j){i.$L.Z("3s")}7(i.U<0){i.1t=i.h.1t="V"}m{i.1t=i.h.1t="2G"}7(i.U!==0){b r=i.4h();i.1i(r,c,"4e");7(s.30===n.1f&&i.F.13!==j){e(n.1f).z("3u.4j",9(t){t.4S();t.4T();t.1n();e(n.1f).R("3u.4j")});b o=e.4O(n.1f,"4V")["3u"];b a=o.4W();o.4X(0,0,a)}}u("R")}b i=d;b s={3e:0,3c:0,4Y:0,3g:0,2l:1d,4Z:1d,50:1d,2m:1d,51:1d,30:1d};i.2g=j;i.$k.z(i.12["3X"],".h-1h",a)},4h:9(){b e=d,t;t=e.4l();7(t>e.C){e.p=e.C;t=e.C}m 7(e.11>=0){t=0;e.p=0}q t},4l:9(){b t=d,n=t.6.14===j?t.2C:t.H,r=t.11,i=1d;e.2i(n,9(s,o){7(r-t.N/20>n[s+1]&&r-t.N/20<o&&t.3m()==="V"){i=o;7(t.6.14===j){t.p=e.4o(i,t.H)}m{t.p=s}}m 7(r+t.N/20<o&&r+t.N/20>(n[s+1]||n[s]-t.N)&&t.3m()==="2G"){7(t.6.14===j){i=n[s+1]||n[n.S-1];t.p=e.4o(i,t.H)}m{i=n[s+1];t.p=s+1}}});q t.p},3m:9(){b e=d,t;7(e.U<0){t="2G";e.2H="Y"}m{t="V";e.2H="1l"}q t},4I:9(){b e=d;e.$k.z("h.Y",9(){e.Y()});e.$k.z("h.1l",9(){e.1l()});e.$k.z("h.1e",9(t,n){e.6.Q=n;e.1e();e.36="1e"});e.$k.z("h.W",9(){e.W();e.36="W"});e.$k.z("h.1i",9(t,n){e.1i(n)});e.$k.z("h.2j",9(t,n){e.2j(n)})},2x:9(){b e=d;7(e.6.2x===j&&e.F.13!==j&&e.6.Q!==c){e.$k.z("57",9(){e.W()});e.$k.z("58",9(){7(e.36!=="W"){e.1e()}})}},1I:9(){b t=d;7(t.6.1I===c){q c}1C(b n=0;n<t.G;n++){b i=e(t.$I[n]);7(i.w("h-1c")==="1c"){4q}b s=i.w("h-1K"),o=i.16(".5b"),u;7(B o.w("1X")!=="2F"){i.w("h-1c","1c");4q}7(i.w("h-1c")===r){o.3N();i.K("4s").w("h-1c","5e")}7(t.6.4t===j){u=s>=t.p}m{u=j}7(u&&s<t.p+t.6.v&&o.S){t.4u(i,o)}}},4u:9(e,t){9 s(){r+=1;7(n.2X(t.2U(0))||i===j){o()}m 7(r<=2v){19(s,2v)}m{o()}}9 o(){e.w("h-1c","1c").Z("4s");t.5j("w-1X");n.6.4x==="4y"?t.5m(5n):t.3L();7(B n.6.3r==="9"){n.6.3r.P(d,[n.$k])}}b n=d,r=0;7(t.5p("5q")==="5r"){t.A("5s-5t","5u("+t.w("1X")+")");b i=j}m{t[0].1X=t.w("1X")}s()},1A:9(){9 s(){i+=1;7(t.2X(n.2U(0))){o()}m 7(i<=2v){19(s,2v)}m{t.1U.A("3h","")}}9 o(){b n=e(t.$I[t.p]).3h();t.1U.A("3h",n+"T");7(!t.1U.1V("1A")){19(9(){t.1U.K("1A")},0)}}b t=d;b n=e(t.$I[t.p]).16("5w");7(n.2U(0)!==r){b i=0;s()}m{o()}},2X:9(e){7(!e.3O){q c}7(B e.4B!=="3b"&&e.4B==0){q c}q j},4n:9(){b t=d;7(t.6.37===j){t.$I.Z("2d")}t.1v=[];1C(b n=t.p;n<t.p+t.6.v;n++){t.1v.2D(n);7(t.6.37===j){e(t.$I[n]).K("2d")}}t.h.1v=t.1v},4w:9(e){b t=d;t.4E="h-"+e+"-5B";t.4F="h-"+e+"-2f"},4k:9(){9 u(e,t){q{2l:"5D",V:e+"T"}}b e=d;e.1G=j;b t=e.4E,n=e.4F,r=e.$I.1E(e.p),i=e.$I.1E(e.15),s=1N.4H(e.H[e.p])+e.H[e.15],o=1N.4H(e.H[e.p])+e.N/2;e.$L.K("h-1Y").A({"-1R-O-1Y":o+"T","-27-4J-1Y":o+"T","4J-1Y":o+"T"});b a="5I 5J 5K 5L";i.A(u(s,10)).K(t).z(a,9(){e.3C=j;i.R(a);e.32(i,t)});r.K(n).z(a,9(){e.2E=j;r.R(a);e.32(r,n)})},32:9(e,t){b n=d;e.A({2l:"",V:""}).Z(t);7(n.3C&&n.2E){n.$L.Z("h-1Y");n.3C=c;n.2E=c;n.1G=c}},4z:9(){b e=d;e.h={29:e.29,5P:e.$k,X:e.$X,I:e.$I,p:e.p,15:e.15,1v:e.1v,13:e.F.13,F:e.F,1t:e.1t}},4N:9(){b r=d;r.$k.R(".h h 1Z.40");e(n).R(".h h");e(t).R("47",r.3f)},1Q:9(){b e=d;7(e.$k.1S().S!==0){e.$L.3y();e.$X.3y().3y();7(e.D){e.D.3j()}}e.4N();e.$k.2s("2t",e.$k.w("h-4p")||"").2s("J",e.$k.w("h-4K"))},5T:9(){b e=d;e.W();18(e.1M);e.1Q();e.$k.5U()},5V:9(t){b n=d;b r=e.3K({},n.29,t);n.1Q();n.1J(r,n.$k)},5W:9(e,t){b n=d,i;7(!e){q c}7(n.$k.1S().S===0){n.$k.1k(e);n.1P();q c}n.1Q();7(t===r||t===-1){i=-1}m{i=t}7(i>=n.$X.S||i===-1){n.$X.1E(-1).5X(e)}m{n.$X.1E(i).5Y(e)}n.1P()},5Z:9(e){b t=d,n;7(t.$k.1S().S===0){q c}7(e===r||e===-1){n=-1}m{n=e}t.1Q();t.$X.1E(n).3j();t.1P()}};e.3A.2c=9(t){q d.2i(9(){7(e(d).w("h-1J")===j){q c}e(d).w("h-1J",j);b n=3i.3E(i);n.1J(t,d);e.w(d,"2c",n)})};e.3A.2c.6={v:5,17:c,1q:[60,4],21:[61,3],24:[62,2],25:c,26:[63,1],4b:c,49:c,1j:2J,1D:64,2u:65,Q:c,2x:c,2b:c,2T:["1l","Y"],2e:j,14:c,1s:j,38:c,2Z:j,48:2J,4a:t,1O:"h-66",28:"h-28",1I:c,4t:j,4x:"4y",1A:c,2I:c,3F:c,3v:j,22:j,23:j,37:c,2w:c,3p:c,3t:c,2M:c,39:c,1F:c,3z:c,3n:c,2R:c,3r:c}})(67,68,69)',0,382,"||||||options|if||function||var|false|this||||owl||true|elem||else|||currentItem|return|||||items|data|||on|css|typeof|maximumItem|owlControls|0px|browser|itemsAmount|positionsInArray|owlItems|class|addClass|owlWrapper|div|itemWidth|transform|apply|autoPlay|off|length|px|newRelativeX|left|stop|userItems|next|removeClass||newPosX|ev_types|isTouch|scrollPerPage|prevItem|find|itemsCustom|clearInterval|setTimeout|transition|disabled|loaded|null|play|target|translate3d|wrapper|goTo|slideSpeed|append|prev|width|preventDefault|paginationWrapper|page|itemsDesktop|autoPlayInterval|pagination|dragDirection|support3d|visibleItems|buttonPrev|css2slide|buttonNext|ms|autoHeight|swapSpeed|for|paginationSpeed|eq|beforeMove|isTransition|transition3d|lazyLoad|init|item|roundPages|checkVisible|Math|baseClass|setVars|unWrap|webkit|children|isCss3Finish|wrapperOuter|hasClass|prevArr|src|origin|mousedown||itemsDesktopSmall|mouseDrag|touchDrag|itemsTablet|itemsTabletSmall|itemsMobile|moz|theme|userOptions|touchend|navigation|owlCarousel|active|rewindNav|in|isCssFinish|html|each|jumpTo|rewind|position|sliding|mouseup|eachMoveUpdate|is|afterGo|ease|attr|style|rewindSpeed|100|transitionStyle|stopOnHover|addCssSpeed|opacity|orignalItems|all|pagesInArray|push|endCurrent|string|right|playDirection|jsonPath|200|pageX|touches|beforeInit|end|move|touchmove|dragging|startDragging|newPosY|navigationText|get|updateItems|touchstart|completeImg|logIn|responsive|targetElement|calculateAll|clearTransStyle|visible|watchVisibility|updateControls|hoverStatus|addClassActive|paginationNumbers|afterInit|checkPagination|undefined|offsetY|checkNavigation|offsetX|resizer|relativePos|height|Object|remove|apStatus|checkAp|moveDirection|afterAction|updateVars|beforeUpdate|Number|afterLazyLoad|grabbing|afterUpdate|click|dragBeforeAnimFinish|event|max|unwrap|afterMove|fn|originalEvent|endPrev|maximumPixels|create|jsonSuccess|wrap|eventTypes|removeTransition|doTranslate|extend|show|css2move|hide|complete|cssText|span|gestures|disabledEvents|updatePagination|loadContent|mousemove|touchcancel|start|buildButtons|buildPagination|disableTextSelect|pageY|min|loops|calculateWidth|appendWrapperSizes|appendItemsSizes|resize|responsiveRefreshRate|itemsScaleUp|responsiveBaseWidth|singleItem|srcElement|outer|drag|animate|setInterval|getNewPosition|reload|disable|singleItemTransition|closestItem|updatePosition|onVisibleItems|inArray|originalStyles|continue|block|loading|lazyFollow|lazyPreload|display|transitionTypes|lazyEffect|fade|owlStatus|moveEvents|naturalWidth|response|buildControls|outClass|inClass|onStartup|abs|customEvents|perspective|originalClasses|checkBrowser|wrapItems|clearEvents|_data|clickable|toggleClass|controls|stopImmediatePropagation|stopPropagation|msMaxTouchPoints|events|pop|splice|baseElWidth|minSwipe|maxSwipe|dargging|clientX|clientY|text|shift|onstartup|mouseover|mouseout|duration|round|lazyOwl|new|which|checked|createElement|destroyControls|buttons|5e3|removeAttr|match|numbers|fadeIn|400|clearTimeout|prop|tagName|DIV|background|image|url|prototype|img|sort|top|ontouchstart|dragstart|out|navigator|relative|appendTo|input|getJSON|textarea|webkitAnimationEnd|oAnimationEnd|MSAnimationEnd|animationend|returnValue|wrapAll|500|baseElement|select|wrapperWidth|option|destroy|removeData|reinit|addItem|after|before|removeItem|1199|979|768|479|800|1e3|carousel|jQuery|window|document".split("|"),0,{})),$(function(){function e(e,t){var i=activeTabId.split("_")[0];$('div[data-siteModule-name="'+e+'"].'+i+"_module_switch").find("div.switch-animate").removeClass("switch-on switch-off").addClass("switch-"+t),"on"===t?$("div[data-siteModule-name="+e+"]."+i+"_module_switch>div>input").attr("checked",!0):$("div[data-siteModule-name="+e+"]."+i+"_module_switch>div>input").removeAttr("checked")}$body=$("body"),$body.on("switch-change","#site-select-deselect-all-module",function(t,i){var a=activeTabId.split("_")[0],s="";s=!1===i.value?"off":"on",$("."+a+"_module_switch").each(function(t,i){e($(i).attr("data-siteModule-name"),s)})});var t="",i=!1,a=!1,s=!1;$body.on("switch-change","div[data-siteModule-name]",function(n,o){var r=$(this),l=activeTabId.split("_")[0],d=r.attr("data-siteModule-name"),m=o.value;t=d,!1===m&&(!1===s&&(i=!0),$("h4#meliscore-tool-module-content-title").html(translations.tr_meliscore_module_management_checking_dependencies),$("."+l+"_module_switch").bootstrapSwitch("setActive",!1),$.ajax({type:"POST",url:"/melis/MelisCms/SitesModuleLoader/getDependents",data:{module:d},dataType:"json",encode:!0}).done(function(t){var i="<br/><br/><div class='container'><div class='row'><div class='col-lg-12'><ul>%s</ul></div></div></div>",s="";$.each(t.modules,function(e,t){s+="<li>"+t+"</li>"}),i=i.replace("%s",s),t.success?melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_nope,translations.tr_meliscms_tool_site_module_load_deactivation_title,t.message+i+translations.tr_melis_cms_sites_module_loading_deactivate_module_with_prerequisites_notice_confirmation,function(){$.each(t.modules,function(t,i){e(i,"off")}),a=!0},function(){e(d,"off"),a=!0}):e(d,"off"),$("."+l+"_module_switch").bootstrapSwitch("setActive",!0),$("h4#meliscore-tool-module-content-title").html(translations.tr_meliscore_module_management_modules),setTimeout(function(){$("body").find(".confirm-modal-header").addClass("module-modal-dependency-checker")},200)}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})),!0===m&&(!1===s&&(i=!1),$("h4#meliscore-tool-module-content-title").html(translations.tr_meliscore_module_management_checking_dependencies),$("."+l+"_module_switch").bootstrapSwitch("setActive",!1),$.ajax({type:"POST",url:"/melis/MelisCms/SitesModuleLoader/getRequiredDependencies?siteId="+l,data:{module:d},dataType:"json",encode:!0}).done(function(t){var i="<br/><br/><div class='container'><div class='row'><div class='col-lg-12'><ul>%s</ul></div></div></div>",s="";$.each(t.modules,function(e,t){s+="<li>"+t+"</li>"}),i=i.replace("%s",s),t.success?melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_nope,translations.tr_meliscms_tool_site_module_load_activation_title,t.message+i+translations.tr_melis_cms_sites_module_loading_activate_module_with_prerequisites_notice_confirmation,function(){$.each(t.modules,function(t,i){e(i,"on"),a=!0}),e(d,"on")},function(){e(d,"on"),a=!0}):e(d,"on"),$("."+l+"_module_switch").bootstrapSwitch("setActive",!0),$("h4#meliscore-tool-module-content-title").html(translations.tr_meliscore_module_management_modules),setTimeout(function(){$("body").find(".confirm-modal-header").addClass("module-modal-dependency-checker")},200)}).fail(function(e,t,i){alert(translations.tr_meliscore_error_message)})),s=!0}),$(document).on("hidden.bs.modal",".module-modal-dependency-checker",function(){!1===a&&e(t,!0===i?"on":"off"),a=!1,i=!1,t="",s=!1}),window.moduleLoadJsCallback=function(){setOnOff(),$("#not-admin-notice").length>0&&$(".has-switch").bootstrapSwitch("setActive",!1)}});var sitesTranslationLoadedTblLists=[];$(function(){var e=$("body"),t=0,i="meliscms_tool_sites_site_translations";e.on("change",".transLangFilter",function(){var e=$(this).parents().eq(6).find("table").attr("id");$("#"+e).DataTable().ajax.reload()}),e.on("click",".mt-tr-refresh",function(){var e=activeTabId.split("_")[0];melisHelper.zoneReload(e+"_id_meliscms_tool_sites_site_translations",i,{siteId:e},function(){$("#"+e+"_id_meliscms_tool_sites_site_translations").addClass("active")})}),e.on("click",".btnEditSiteTranslation",function(){var e=$(this),t=e.closest("tr").attr("data-lang-id"),i=e.closest("tr").attr("data-site-id"),a=e.closest("tr").find("td:nth-child(2)").text();e.closest("tr").attr("data-mstt-id"),e.closest("tr").attr("data-mst-id");melisHelper.createModal("id_meliscms_tool_sites_site_translations_modal_edit","meliscms_tool_sites_site_translations_modal_edit",!0,{translationKey:a,langId:t,siteId:i},"/melis/MelisCms/SitesTranslation/renderToolSitesSiteTranslationModal")}),e.on("click","#btnDeleteSiteTranslation",function(e){var t=activeTabId.split("_")[0],a=$(this).closest("tr").attr("data-mst-id"),s=($(this).closest("tr").attr("data-mstt-id"),$(this).closest("tr").attr("data-site-id")),n={};n.mst_id=a,n.siteId=s,0!=a&&""!=a&&melisCoreTool.confirm(translations.tr_meliscore_common_yes,translations.tr_meliscore_common_no,translations.tr_melis_site_translation_name,translations.tr_melis_site_translation_delete_confirm,function(){$.ajax({type:"POST",url:"/melis/MelisCms/SitesTranslation/deleteTranslation",data:$.param(n)}).done(function(e){e.success&&(melisHelper.melisOkNotification(translations.tr_meliscore_common_success,translations.tr_melis_site_translation_delete_success),melisHelper.zoneReload(t+"_id_meliscms_tool_sites_site_translations",i,{siteId:t},function(){$("#"+t+"_id_meliscms_tool_sites_site_translations").addClass("active")}))})}),e.preventDefault()}),e.on("click",".btnSaveSiteTranslation",function(e){var a=activeTabId.split("_")[0],s=$("form[name='sitestranslationform']").serializeArray();$.ajax({type:"POST",url:"/melis/MelisCms/SitesTranslation/saveTranslation",data:$.param(s)}).done(function(e){e.success?(0==t?melisHelper.melisOkNotification(translations.tr_meliscore_common_success,translations.tr_melis_site_translation_inserting_success):melisHelper.melisOkNotification(translations.tr_meliscore_common_success,translations.tr_melis_site_translation_update_success),$("#modal-site-translation").modal("hide"),melisHelper.zoneReload(a+"_id_meliscms_tool_sites_site_translations",i,{siteId:a},function(){t=0,0,$("#"+a+"_id_meliscms_tool_sites_site_translations").addClass("active")})):(melisHelper.melisKoNotification(translations.tr_melis_site_translations,translations.tr_melis_site_translation_save_failed,e.errors),$.each(e.langErrorIds,function(t,i){melisCoreTool.highlightErrors(0,e.errors,i+"_site-translation-form")}))}),e.preventDefault()}),e.on("shown.bs.tab",".sites-tool-tabs a[data-toggle='tab']",function(){if($(window).width()<=768){var e=$(this).attr("href"),t=(e=e.replace("#","")).replace(/\d+/g,"");if(""!=e){var i=e.split("_");"_id_meliscms_tool_sites_site_translations"==t&&$("#"+i[0]+"_tableMelisSiteTranslation").DataTable().columns.adjust().responsive.recalc()}}})}),window.siteTransTableCallBack=function(e,t){var i=activeTabId.split("_")[0];$("#"+i+"_tableMelisSiteTranslation tbody tr[data-mst-id='0']").find("#btnDeleteSiteTranslation").remove()},window.initAdditionalTransParam=function(e){var t=activeTabId.split("_")[0];e.site_translation_language_name=$("#"+t+"_siteTranslationLanguageName").val(),e.siteId=t};
